(()=>{var _i="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var gi=(n=21)=>{let t="",o=n;for(;o--;)t+=_i[Math.random()*64|0];return t},qr=gi;var Ge=class extends Error{constructor(t){super(t),this.name="i.js \u2764\uFE0F  brackets parse ERROR"}};function vi({open:n,close:t,pos:o,nodes:a},u,f){return{nodeType:"bracket",open:n,close:t,nodes:a,pos:Object.assign({},o,{end:u}),content:f.substring(o.start,u+1),innerContent:f.substring(o.start+1,u)}}function Si(n){let t=new Map;return n.forEach(([o,a=o])=>t.set(o,a)),{quotes:t}}function Ti(n){let t={},o={};return n.forEach(([a,u])=>{o[a]=u,t[u]=a}),{opens:t,closes:o}}function In(n){let{text:t,parent:o,start:a,end:u,opt:f}=n;if(a===u&&!f.includeEmpty)return;let y=f.pairs.reduce((w,N)=>w.concat(N.split("")),[]).map(w=>`${f.escape}${w}`),_=w=>y.reduce((N,F)=>N.split(F).join(F[1]),w),E=o.pos.depth+1;o.nodes.push({nodeType:"text",pos:{start:a,end:u,depth:E},content:_(t.substring(a,u))})}var Nn=n=>{let t=n.pop();if(t===void 0)throw new Ge("LogicError :)");return t};function nt(n,t){let a=Object.assign({pairs:["()","{}","[]"],nestMax:100,escape:"\\",skip:!1,includeEmpty:!1,quotes:['"',"'","`"]},t||{}),{pairs:u,nestMax:f,escape:y,skip:_}=a,{opens:E,closes:w}=Ti(u),{quotes:N}=Si(a.quotes),F=[{nodeType:"root",nodes:[],pos:{start:0,end:0,depth:-1},content:n}],D=0,te=null,I=0;for(let ne=0;ne<n.length;ne++){let re=Nn(F),J=n[ne],d=ne>0&&n[ne-1]===y;if(_&&["{","}","(",")","[","]"].includes(J)&&re.nodeType==="root")F.push(re);else if(_&&["{","(","["].includes(re.open)&&(J==="<"||J===">"))F.push(re);else if(d)F.push(re);else if(te!==null)te===J&&(te=null),F.push(re);else if(N.has(J))te=N.get(J),I=ne,F.push(re);else if(w[J]!==void 0){if(F.length>=f)throw new Ge(`over nest max limit. options: { nestMax: '${a.nestMax}' }`);In({text:n,parent:re,start:D,end:ne,opt:a}),F.push(re),F.push({nodeType:"bracket-open",pos:{start:ne,depth:re.pos.depth+1},open:J,close:w[J],nodes:[]}),D=ne+1}else if(E[J]!==void 0){if(re.nodeType==="root"||E[J]!==re.open)throw new Ge(`404 pair '${E[J]}' :${ne}`);let be=Nn(F);In({text:n,parent:re,start:D,end:ne,opt:a});let Ce=vi(re,ne,n);be.nodes.push(Ce),F.push(be),D=ne+1}else F.push(re)}if(te!==null)throw new Ge(`unclosed quote ${te} near "...${n.substring(D-20,D+30)}..."`);let ve=Nn(F);if(ve.nodeType!=="root")throw new Ge(`404 pair '${ve.open}' :${ve.pos.start}`);return In({text:n,parent:ve,start:D,end:n.length,opt:a}),ve.nodes}function Vr(n){return[...n].reduce((t,o)=>(t.quote?(o===t.quote&&(t.quote=void 0),t.a[t.a.length-1]+=o):o==="="?t.a[t.a.length-1].length?t.a.push("="):t.a[t.a.length-1]="=":o===" "?t.a[t.a.length-1]!=="="&&t.a[t.a.length-1].length&&t.a.push(""):(['"',"'","`"].includes(o)&&(t.quote=o),t.a[t.a.length-1]+=o),t),{a:[""]}).a}function _t(n,t="|",o=!1){let a=[...n].reduce((u,f)=>(u.quote?(f===u.quote&&(u.quote=void 0),u.a[u.a.length-1]+=f):f===t?u.a.push(""):(['"',"'","`"].includes(f)&&(u.quote=f),u.a[u.a.length-1]+=f),u),{a:[""]}).a;return o?a.filter(u=>u):a}function Jr(n,t="|"){var o=n.lastIndexOf(t);return[n.substr(0,o),n.substr(o+1)]}function Ei(n){if(['"',"'","`"].includes(n[0])&&n[0]===n[n.length-1]){for(var t=1;t<n.length-1;){if(n[t]===n[0]&&n[t-1]!=="\\")return!1;t++}return!0}return!1}function xi(n){return n.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2={};let o=t.opts.find(_=>_.type==="loop");if(o){let _=o.key;t.opts2.key=new Function(`return ${_}`)();let E=o.value.split(" as ");if(!E[1])throw"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D \u0430\u043B\u0438\u0430\u0441 \u0434\u043B\u044F loop";let w=E[1].split(",");t.opts2.loop_fn=E[0].trim(),t.opts2.loop_alias=w[0].trim(),w[1]&&(t.opts2.loop_key_alias=w[1].trim())}let a=t.opts.find(_=>_.type==="text");a&&(Ei(a.value)?t.opts2.text=a.value.substring(1,a.value.length-1):t.opts2.textFn=a.value),["if","style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(_=>{let E=t.opts.find(w=>w.type===_);E&&(t.opts2[_]=E.value)}),t.opts.filter(_=>_.type==="eventCallback").forEach(_=>{t.opts2.events||(t.opts2.events={});let E=_.key.substr(1);if(t.opts2.events[E])throw`i.js compile error: Duplicate event name "${E}"`;_.value=_.value.substring(1,_.value.length-1).trim(),_.value[0]==="{"?_.value=_.value.substring(0,_.value.length-1)+";this.render()}":_.value="("+_.value+")==this.render()",t.opts2.events[E]=_.value}),t.opts.filter(_=>_.type==="eventBind"||_.type==="eventBindSelfNamed").forEach(_=>{t.opts2.events||(t.opts2.events={});let E=_.key.substr(1);if(t.opts2.events[E])throw`i.js compile error: Duplicate event name "${E}"`;t.opts2.events[E]=new Function(`return (...args) => this.${_.value}(...args)`)()}),t.opts.filter(_=>_.type==="eventCallFunction").forEach(_=>{t.opts2.events||(t.opts2.events={});let E=_.key.substr(1);if(t.opts2.events[E])throw`i.js compile error: Duplicate event name "${E}"`;t.opts2.events[E]=`${_.value}${_.args}`})}),n.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2||(t.opts2={}),t.opts2.attrs2||(t.opts2.attrs2={},t.opts2.attrsB={},t.opts2.attrsR={}),t.opts.filter(f=>f.type==="booleanAttribute").forEach(f=>{t.opts2.attrs2[f.key]&&console.warn(`i.js compile warning: direct attibute "${f.key}" override attrs({...${f.key}...}) declaration in tag ""!`),t.opts2.attrs2[f.key]=f.key,t.opts2.attrsB[f.key]=!0}),t.opts.filter(f=>f.type==="stringAttribute").forEach(f=>{t.opts2.attrs2[f.key]&&console.warn(`i.js compile warning: direct attibute "${f.key}" override attrs({...${f.key}...}) declaration in tag ""!`),t.opts2.attrs2[f.key]=f.value}),t.opts.filter(f=>f.type==="jsAttribute").forEach(f=>{if(f.key[0]==="%"){var y=f.key.substr(1);t.opts2.attrsR[y]=f.value}else var y=f.key;t.opts2.attrs2[y]&&console.warn(`i.js compile warning: direct attibute "${y}" override attrs({...${y}...}) declaration in tag ""!`),t.opts2.attrs2[y]=f.value.endsWith("%")?f.value:f})}),n.forEach(t=>{t.opts2&&t.opts2.attrs2&&!Object.keys(t.opts2.attrs2).length&&(delete t.opts2.attrs2,delete t.opts2.attrsB),t.opts2&&t.opts2.events&&!Object.keys(t.opts2.events).length&&delete t.opts2.events}),n}function Ie({AAA:n,item:t,tag:o,a},u="enter",f="enterStyles"){if(a===u&&n.length){let y=n.shift().content;if(y[0]==="("){if(t.opts.find(_=>_.type===u))throw`i.js template parse error: duplicate ${u}() inside "<${o}>" declaration`;t.opts.push({type:f,value:y.slice(1,-1)})}else throw`i.js template parse error: expected "${u}(..." but "${u}${y[0]}..." found inside "<${o}>"`;return!0}return!1}function Wr(n){return n.filter(t=>t.nodeType==="bracket"&&t.innerContent[0]!=="/").forEach(t=>{t.opts=[];let o=nt(t.innerContent).map(u=>({nodeType:u.nodeType,content:u.content.trim()}));var a="";do{let u=o.shift();if(u.nodeType==="bracket")if(t.opts.length){let f=t.opts[t.opts.length-1];if(f.type==="jsAttribute")f.value+=u.content;else throw`i.js template parse error: unxpected brackets "${u.content}" at the end of <${a}> attributes`}else throw`i.js template parse error: unxpected brackets "${u.content}" at the end of <${a}> attributes`;else if(u.nodeType==="text"){let f=Vr(u.content);a||(a=f.shift());do{let y=f.shift();if(f[0]&&f[0][0]==="="){let _=f.shift().substr(1);if(y[0]==="@"){if(['"',"'","`"].includes(_[0]))throw`i.js template parse error: quotes around ${_} is prohibited`;if(o.length&&o[0].nodeType==="bracket"){let E=o.shift();t.opts.push({type:"eventCallFunction",key:y,value:_,args:E.content})}else t.opts.push({type:"eventBind",key:y,value:_.endsWith("/")?_.substring(0,_.length-1):_})}else if(_.startsWith('"')&&_.endsWith('"')||_.startsWith("`")&&_.endsWith("`")||_.startsWith("'")&&_.endsWith("'"))t.opts.push({type:"stringAttribute",key:y,value:_.slice(1,-1)});else if(_.length)t.opts.push({type:"jsAttribute",key:y,value:_.endsWith("/")?_.substring(0,_.length-1):_});else{if(!o.length)throw`i.js template parse error: unxpected end of attribute "...${y}=" inside "<${a}>" declaration`;let E=o.shift().content;E[0]==="{"?t.opts.push({type:"eueAttribute",key:y,value:E}):E[0]==="["?t.opts.push({type:"transitionAttribute",key:y,value:E}):t.opts.push({type:"jsAttribute",key:y,value:E.substring(1,E.length-1)})}}else if(y==="loop"&&o.length){let _=o.shift().content;if(_[0]==="("){if(t.opts.find(N=>N.type==="loop"))throw`i.js template parse error: duplicate loop${_} inside "<${a}>" declaration`;let[E,w]=Jr(_.slice(1,-1));if(w)t.opts.push({type:"loop",key:w,value:E});else throw`i.js template parse error: non-keyed loop not supported yet. "loop${_}" inside "<${a}>"`}else throw`i.js template parse error: expected "loop(..." but "loop${_[0]}..." found inside "<${a}>" `}else if(!Ie({AAA:o,item:t,tag:a,a:y},"if","if")){if(!Ie({AAA:o,item:t,tag:a,a:y},"style","style")){if(!Ie({AAA:o,item:t,tag:a,a:y},"attrs","attrs")){if(!Ie({AAA:o,item:t,tag:a,a:y},"enter","enterStyles")){if(!Ie({AAA:o,item:t,tag:a,a:y},"update","updateStyles")){if(!Ie({AAA:o,item:t,tag:a,a:y},"exit","exitStyles")){if(!Ie({AAA:o,item:t,tag:a,a:y},"#enter","enterAttrs")){if(!Ie({AAA:o,item:t,tag:a,a:y},"#update","updateAttrs")){if(!Ie({AAA:o,item:t,tag:a,a:y},"#exit","exitAttrs")){if(y==="text"&&o.length){let _=o.shift().content;if(_[0]==="("){if(t.opts.find(E=>E.type==="text"))throw`i.js template parse error: duplicate text{c} inside "<${a}>" declaration`;t.opts.push({type:"text",value:_.slice(1,-1)})}else throw`i.js template parse error: expected "text(..." but "text{c[0]}..." found inside "<${a}>"`}else if(y)if(y[0]==="@")if(!f.length&&o[0]&&o[0].nodeType==="bracket"){let _=o.shift();t.opts.push({type:"eventCallback",key:y,value:_.content})}else y.endsWith("/")?t.opts.push({type:"eventBindSelfNamed",key:y.trim().slice(0,-1),value:y.trim().slice(1,-1)}):t.opts.push({type:"eventBindSelfNamed",key:y.trim(),value:y.trim().slice(1)});else{if(y==="=")throw`i.js template parse error: unxpected end of attribute "${y}" inside "<${a}>" declaration`;y!=="/"&&t.opts.push({type:"booleanAttribute",key:y})}}}}}}}}}}}while(f.length)}}while(o.length)}),xi(n)}var Rn={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,menuitem:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0};var Yt=class extends Error{constructor(t){super(t),this.name="i.js \u2764\uFE0F  syntax ERROR"}};function Bn(n,t=[]){if(!t.length)return n;if(n[0]=="@"){if(n.length===1)throw"empty alias tag <@>";let o=t.find(a=>a.alias===n);if(o)n=o.name;else throw`alias <${n}> not defined`}return n}function kn(n,t){let o=t.find(a=>a.name===n);return o?o.alias:n}function Ai(n,t){let o=[{children:[]}];if(o.last=()=>o[o.length-1],n.forEach(a=>{if(a.nodeType==="text"){var u=o[o.length-1];if(u.text)throw"children and text() attribute at the same time";u.children.push({tag:"#text",content:a.content})}else{var f=a.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?\\/>$","s"));if(f){var u=o[o.length-1];if(u.text)throw"children and text() attribute at the same time";u.children.push(Object.assign({tag:Bn(f[1],t)},a.opts2))}else{var y=a.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(y)if(Rn[y[1]]){let E=o[o.length-1];if(E.text)throw"children and text() attribute at the same time";E.children.push(Object.assign({tag:Bn(y[1],t)},a.opts2))}else o.push(Object.assign({tag:Bn(y[1],t),children:[]},a.opts2));else{var _=a.content.match(new RegExp("^<\\/(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(_){if(Rn[_[1]])throw`can't close self-closing tag "</${_[1]}>"`;let E=o[o.length-2],w=o.pop();if(w.children.length===1&&w.children[0].tag==="#text"?(w.text=w.children[0].content,delete w.children):w.children.length||delete w.children,E){if(E.text)throw"children and text() attribute at the same time";let N=kn(w.tag,t),F=kn(_[1],t);if(N!==F)throw`the opening and closing tags are not the same <${N}>...</${F}>`;E.children.push(w)}else throw!w.children||w.children[0].tag!==_[1]?`missing the opening tag for </${_[1]}>`:`closed twice tag <${w.children[0].tag}>`}}}}}),o.length>1){let a=o.find(u=>u.tag);throw`Unclosed tag <${kn(a.tag,t)}>`}return o[0].children}var Qr=Ai;var rt={};rt.animate=function(n,t,o,a,u,f){if(typeof n!="number"||typeof t!="number"||typeof o!="number"||typeof a!="function")return;typeof u=="string"&&K[u]&&(u=K[u]),typeof u!="function"&&(u=K.linear),typeof f!="function"&&(f=function(){});var y=window.requestAnimationFrame||function(F){window.setTimeout(F,1e3/60)},_=!1,E=t-n;function w(F){if(!_){var D=(F||+new Date)-N;D>=0&&a(u(D,n,E,o)),D>=0&&D>=o?(a(t),f()):y(w)}}a(n);var N=window.performance&&window.performance.now?window.performance.now():+new Date;return y(w),{cancel:function(){_=!0}}};rt.animateCSS=function(n,t,o,a,u,f,y,_){var E=function(w){n.style[t]=w+o};return rt.animate(a,u,f,E,y,_)};rt.cancel=function(n){n&&n.cancel()};var K=rt.easings={};K.linear=function(n,t,o,a){return o*n/a+t};K.easeInQuad=function(n,t,o,a){return o*(n/=a)*n+t};K.easeOutQuad=function(n,t,o,a){return-o*(n/=a)*(n-2)+t};K.easeInOutQuad=function(n,t,o,a){return(n/=a/2)<1?o/2*n*n+t:-o/2*(--n*(n-2)-1)+t};K.easeInCubic=function(n,t,o,a){return o*(n/=a)*n*n+t};K.easeOutCubic=function(n,t,o,a){return o*((n=n/a-1)*n*n+1)+t};K.easeInOutCubic=function(n,t,o,a){return(n/=a/2)<1?o/2*n*n*n+t:o/2*((n-=2)*n*n+2)+t};K.easeInQuart=function(n,t,o,a){return o*(n/=a)*n*n*n+t};K.easeOutQuart=function(n,t,o,a){return-o*((n=n/a-1)*n*n*n-1)+t};K.easeInOutQuart=function(n,t,o,a){return(n/=a/2)<1?o/2*n*n*n*n+t:-o/2*((n-=2)*n*n*n-2)+t};K.easeInQuint=function(n,t,o,a){return o*(n/=a)*n*n*n*n+t};K.easeOutQuint=function(n,t,o,a){return o*((n=n/a-1)*n*n*n*n+1)+t};K.easeInOutQuint=function(n,t,o,a){return(n/=a/2)<1?o/2*n*n*n*n*n+t:o/2*((n-=2)*n*n*n*n+2)+t};K.easeInSine=function(n,t,o,a){return-o*Math.cos(n/a*(Math.PI/2))+o+t};K.easeOutSine=function(n,t,o,a){return o*Math.sin(n/a*(Math.PI/2))+t};K.easeInOutSine=function(n,t,o,a){return-o/2*(Math.cos(Math.PI*n/a)-1)+t};K.easeInExpo=function(n,t,o,a){return n==0?t:o*Math.pow(2,10*(n/a-1))+t};K.easeOutExpo=function(n,t,o,a){return n==a?t+o:o*(-Math.pow(2,-10*n/a)+1)+t};K.easeInOutExpo=function(n,t,o,a){return n==0?t:n==a?t+o:(n/=a/2)<1?o/2*Math.pow(2,10*(n-1))+t:o/2*(-Math.pow(2,-10*--n)+2)+t};K.easeInCirc=function(n,t,o,a){return-o*(Math.sqrt(1-(n/=a)*n)-1)+t};K.easeOutCirc=function(n,t,o,a){return o*Math.sqrt(1-(n=n/a-1)*n)+t};K.easeInOutCirc=function(n,t,o,a){return(n/=a/2)<1?-o/2*(Math.sqrt(1-n*n)-1)+t:o/2*(Math.sqrt(1-(n-=2)*n)+1)+t};K.easeInElastic=function(n,t,o,a){var u=0,f=o;if(n==0)return t;if((n/=a)==1)return t+o;if(u||(u=a*.3),f<Math.abs(o)){f=o;var y=u/4}else var y=u/(2*Math.PI)*Math.asin(o/f);return-(f*Math.pow(2,10*(n-=1))*Math.sin((n*a-y)*(2*Math.PI)/u))+t};K.easeOutElastic=function(n,t,o,a){var u=0,f=o;if(n==0)return t;if((n/=a)==1)return t+o;if(u||(u=a*.3),f<Math.abs(o)){f=o;var y=u/4}else var y=u/(2*Math.PI)*Math.asin(o/f);return f*Math.pow(2,-10*n)*Math.sin((n*a-y)*(2*Math.PI)/u)+o+t};K.easeInOutElastic=function(n,t,o,a){var u=0,f=o;if(n==0)return t;if((n/=a/2)==2)return t+o;if(u||(u=a*(.3*1.5)),f<Math.abs(o)){f=o;var y=u/4}else var y=u/(2*Math.PI)*Math.asin(o/f);return n<1?-.5*(f*Math.pow(2,10*(n-=1))*Math.sin((n*a-y)*(2*Math.PI)/u))+t:f*Math.pow(2,-10*(n-=1))*Math.sin((n*a-y)*(2*Math.PI)/u)*.5+o+t};K.easeInBack=function(n,t,o,a,u){return u==null&&(u=1.70158),o*(n/=a)*n*((u+1)*n-u)+t};K.easeOutBack=function(n,t,o,a,u){return u==null&&(u=1.70158),o*((n=n/a-1)*n*((u+1)*n+u)+1)+t};K.easeInOutBack=function(n,t,o,a,u){return u==null&&(u=1.70158),(n/=a/2)<1?o/2*(n*n*(((u*=1.525)+1)*n-u))+t:o/2*((n-=2)*n*(((u*=1.525)+1)*n+u)+2)+t};K.easeInBounce=function(n,t,o,a){return o-K.easeOutBounce(a-n,0,o,a)+t};K.easeOutBounce=function(n,t,o,a){return(n/=a)<1/2.75?o*(7.5625*n*n)+t:n<2/2.75?o*(7.5625*(n-=1.5/2.75)*n+.75)+t:n<2.5/2.75?o*(7.5625*(n-=2.25/2.75)*n+.9375)+t:o*(7.5625*(n-=2.625/2.75)*n+.984375)+t};K.easeInOutBounce=function(n,t,o,a){return n<a/2?K.easeInBounce(n*2,0,o,a)*.5+t:K.easeOutBounce(n*2-a,0,o,a)*.5+o*.5+t};var gt=rt;var Ne={duration:500};function Fn(n,t,o){var a=n[t];if(t<o)for(;t<o;t++)n[t]=n[t+1];else for(;t>o;t--)n[t]=n[t-1];n[o]=a}function st(n){if(n.svg)var t=document.createElementNS("http://www.w3.org/2000/svg",n.tag);else var t=document.createElement(n.tag);return Object.assign(t,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}}),t}var Hr=n=>`
    var element = document.createElement("${n}");
    Object.assign(element, {_attrs:{},_styles:{},_attrsV:{},_styleV:{}, _colors:{}});
`,Kr=n=>`
    var element = document.createElementNS("http://www.w3.org/2000/svg", "${n}");
    Object.assign(element, {_attrs:{},_styles:{},_attrsV:{},_styleV:{}, _colors:{}});
`;function ot(n,t,o){var a="linear";if(typeof o=="object"){var u=o.duration||Ne.duration,f=o.to;o.ease&&(a=o.ease)}else var u=Ne.duration,f=o;var y=n.getAttribute(t)?Number(n.getAttribute(t)):0;gt.cancel(n._attrs[t]),n._attrs[t]=gt.animate(y,f,u,_=>{n.setAttribute(t,_)},a)}function wi(n,t,o){var a="linear",u=0;if(typeof o=="object"){var f=o.duration||Ne.duration,y=o.to;o.ease&&(a=o.ease),o.delay&&(u=o.delay)}else var f=Ne.duration,y=o;n._colors[t]={key:t,duration:f,ease:a,delay:u},setTimeout(()=>{delete n._colors[t];var E=Object.values(n._colors).map(w=>w.key+" "+w.duration+"ms "+w.ease+" "+w.delay+"ms").join(",");n.style.setProperty("transition",E||"none")},f+u);var _=Object.values(n._colors).map(E=>E.key+" "+E.duration+"ms "+E.ease+" "+E.delay+"ms").join(",");n.style.setProperty("transition",_||"none"),n.style.getPropertyValue(t)||n.style.setProperty(t,"#000000"),setTimeout(()=>{n.style.setProperty(t,y)},0)}function qt(n,t,o){if(["color","background","fill","stroke","background-color","border-color"].includes(t)){wi(n,t,o);return}var a="linear",u=0;if(typeof o=="object"){var f=o.duration||Ne.duration,y=o.to;o.from&&(u=o.from),o.ease&&(a=o.ease)}else var f=Ne.duration,y=o;var _=n.style[t],E="";typeof y=="string"&&(y.endsWith("px")?(u=Number(_.substring(0,_.length-2)),y=Number(y.substring(0,y.length-2)),E="px"):y.endsWith("%")&&(u=Number(_.substring(0,_.length-1)),y=Number(y.substring(0,y.length-1)),E="%")),gt.cancel(n._styles[t]),n._styles[t]=gt.animate(u,y,f,w=>{n.style.setProperty(t,w+E)},a)}function vt(n,t){return!!(n==="input"&&["checked","autofocus","readonly","required","disabled","multiple"].includes(t)||n==="option"&&["selected"].includes(t)||n==="button"&&["disabled","multiple"].includes(t))}function Xr(n,t,o,a,u){var f=u;return ot(n,a,f),typeof f=="object"&&f.duration?f.duration:Ne.duration;return 0}function Zr(n,t,o,a,u){var f=u;return qt(n,a,f),typeof f=="object"&&f.duration?f.duration:Ne.duration;return 0}function es(n,t,o,a,u,f){var y=0,_=0;if(t.exitAttrs){var E=t.exitAttrs(o);typeof E=="object"&&(_=Object.entries(E).reduce((N,F)=>Math.max(Xr(n,t,o,F[0],F[1]),N),0))}if(t.exitStyles){var w=t.exitStyles(o);typeof w=="object"&&(y=Object.entries(w).reduce((N,F)=>Math.max(Zr(n,t,o,F[0],F[1]),N),0))}if(y>0||_>0){let N=setTimeout(()=>f.Done.then(()=>{n.remove(),u.exit.delete(a)}),y>_?y:_);u.exit.set(a,{element:n,timeout:N});return}n.remove()}function ts(n,t,o,a,u){var f=0,y=0;if(t.exitAttrs){var _=t.exitAttrs(o);typeof _=="object"&&(y=Object.entries(_).reduce((w,N)=>Math.max(Xr(n,t,o,N[0],N[1]),w),0))}if(t.exitStyles){var E=t.exitStyles(o);typeof E=="object"&&(f=Object.entries(E).reduce((w,N)=>Math.max(Zr(n,t,o,N[0],N[1]),w),0))}if(f>0||y>0){let w=setTimeout(()=>a.Done.then(()=>{n.remove(),a.__i__[u]=!1}),f>y?f:y);return a.__i__[u]={exit:w},!1}return a.__i__[u]=!1,n.remove(),!0}function St(n,t,o,a,u,f,y){var _=u.keys,E=u.elements,w=u.exit,N=E.length,F=y.length,D=N>F?N:F,te=0,I=0,ve=0;do{if(I<F){var ne=n.key(y[I]);if(I>=N){N++,D=N>F?N:F;var re=w.get(ne);if(re){clearTimeout(re.timeout);var J=re.element;w.delete(ne)}else var J=st(n);if(a[n.loop_alias]=y[I],n.loop_key_alias&&(a[n.loop_key_alias]=I),Mn(J,n,a,ye),I===0)if(w.size)for(let Me of w){Me[1].element.before(J);break}else o?o.after(J):t.prepend(J);else E[I-1].after(J);E.splice(I,0,J),J.key=ne,_[ne]=!0,I++;continue}else{var d=E[I].key;if(ne===d){a[n.loop_alias]=y[I],n.loop_key_alias&&(a[n.loop_key_alias]=I),n.Update_Tag(E[I],n,a,ye),I++;continue}else if(_[ne]){var be=void 0,Ce=void 0;let Me;for(var he=I+1;he<D;he++)if(!be&&he<N&&E[he].key===ne&&(be=he+1),!Ce&&he<F&&n.key(y[he])===d&&(Ce=he+1),be&&Ce){var ut=E[I];if(be>=Ce)Me=E[be-1],t.insertBefore(Me,ut),a[n.loop_alias]=y[I],n.loop_key_alias&&(a[n.loop_key_alias]=I),n.Update_Tag(Me,n,a,ye),be===Ce?(he-I>1&&t.insertBefore(ut,E[be]),E[I]=E[he],E[he]=ut):(Fn(E,be-1,I),te++),I++;else{var pt=Ce-1+te;t.insertBefore(ut,E[pt]||null),Fn(E,I,(pt>N?N:pt)-1),te--,a[n.loop_alias]=y[I],n.loop_key_alias&&(a[n.loop_key_alias]=I),n.Update_Tag(E[I],n,a,ye)}break}if(Me)continue}else{N++,D=N>F?N:F;var re=w.get(ne);if(re)clearTimeout(re.timeout),J=re.element,w.delete(ne);else var J=st(n);a[n.loop_alias]=y[I],n.loop_key_alias&&(a[n.loop_key_alias]=I),Mn(J,n,a,ye),I===0?o?o.after(J):t.prepend(J):E[I-1].after(J),E.splice(I,0,J),J.key=ne,_[ne]=!0,I++;continue}}}delete _[E[I].key],n.loop_key_alias&&(a[n.loop_key_alias]=I+ve,ve++),es(E[I],n,a,E[I].key,u,t),E.splice(I,1),N--,D=N>F?N:F}while(I<D);return u.length=E.length,w.size+u.length}function $i(){return{ret_element:function(n,t,o,a){return n},children:function(n,t,o,a){a.UPDATE_Chidldren(n,t.children,o)},fn_text:function(n,t,o,a){var u=t.text(o);n.__lastText!==u&&(n.textContent=n.__lastText=u)},updateProps:function(n,t,o,a){t.updateProps(n,t,o,a)}}}function Vt(n){var t=[],o=$i();return n.tag==="#text"?(t.push(o.ret_element),t):(n.children?t.push(o.children):typeof n.text=="function"&&t.push(o.fn_text),n.updateProps&&(t=[...t,...n.updateProps]),t.push(o.ret_element),t)}function Ci(n,t,o,a,u,f){return t.Update_Tag(n.childNodes[u],t,o,ye),u+1}function Oi(n,t,o,a,u,f){let y=t.loop(o);if(!f||f.length===0){if(!f||f.exit.size===0)return y.length?a===0?(t.enter(t,n,void 0,o,a,y,ye),u+n.__i__[a].length):(t.enter(t,n,u===0?void 0:n.childNodes[u-1],o,a,y,ye),u+n.__i__[a].length):u;if(y.length){let _=St(t,n,a===0||u===0?void 0:n.childNodes[u],o,f,a,y);return u+_}else return u+f.exit.size}else if(y.length){let _=St(t,n,a===0||u===0?void 0:n.childNodes[u-1],o,f,a,y);return u+_}else{let _=St(t,n,a===0||u===0?void 0:n.childNodes[u],o,f,a,y);return u+_}}function Li(n,t,o,a,u,f){if(f===!1)if(t.if(o)){let _=st(t);if(t.children)Ye(_,t.children,o);else{var y=typeof t.text=="function"?t.text(o):t.text;_.__lastText!==y&&(_.textContent=_.__lastText=y)}return t.enterProps&&t.enterProps(_,t,o,ye),u===0?n.prepend(_):n.childNodes[u-1].after(_),n.__i__[a]={exit:!1},u+1}else return u;else return t.if(o)?f.exit?(clearTimeout(f.exit),t.enterProps&&t.enterProps(n.childNodes[u],t,o,ye),n.__i__[a]={exit:!1},u+1):(typeof t.text!="string"&&t.Update_Tag(n.childNodes[u],t,o,ye),u+1):f.exit?u+1:ts(n.childNodes[u],t,o,n,a)?u:u+1}function Pi(n,t,o,a,u,f){if(f===!1||f.length===0)if(t.if(o)){let y=t.loop(o);return y.length?a===0?(t.enter(t,n,void 0,o,a,y,ye),u+n.__i__[a].length):(t.enter(t,n,u===0?void 0:n.childNodes[u-1],o,a,y,ye),u+n.__i__[a].length):u}else return u;else if(t.if(o)){let y=t.loop(o),_=St(t,n,a===0&&u===0?void 0:n.childNodes[u],o,f,a,y);return u+_}else{if(f.length===0)return u+f.exit.size;{let y=St(t,n,a===0&&u===0?void 0:n.childNodes[u],o,f,a,[]);return u+y}}}function Tt(n,t,o){var a=void 0;n.Done=new Promise(f=>a=f);var u=0;t.forEach((f,y)=>{let _=n.__i__[y];if(f.tag==="#text"){u++;return}f.hasOwnProperty("if")?f.loop?u=Pi(n,f,o,y,u,_):u=Li(n,f,o,y,u,_):f.loop?u=Oi(n,f,o,y,u,_):u=Ci(n,f,o,y,u,_)}),a()}function ns(n,t,o,a){if(n.tag==="input"&&o==="value")t._attrsV[o]!==a&&(t._attrsV[o]=a,t.value!=a&&(t.value=a));else if(o==="class"){if(typeof a=="object")throw"Cannot do transition on  class attribute";var u=a||void 0;t._attrsV[o]!==u&&(t._attrsV[o]=u,u?n.svg?t.setAttribute(o,u):t.className=u:t.removeAttribute(o))}else if(typeof a=="object"||t._attrsV[o]!==a||Array.isArray(a))if(t._attrsV[o]=a,vt(n.tag,o)){if(typeof a=="object")throw"Cannot do transition on boolean attribute";n.tag==="input"&&n.attrs2.type==="radio"&&o==="checked"&&!n.attrsB[o]?a?(t.setAttribute(o,""),t[o]=o):(t.removeAttribute(o),t[o]=""):a?t.setAttribute(o,"")||(t[o]=o):t.removeAttribute(o)||(t[o]="")}else n.tag==="textarea"&&o==="value"?t.value=a:!n.attrs3[o]&&typeof a=="object"?ot(t,o,a):t.setAttribute(o,a)}function Ii(){return{updateAttrs:function(n,t,o,a){Object.entries(t.updateAttrs(o)).forEach(([u,f])=>{a.updateAttribute(t,n,u,f)})},attrs3:function(n,t,o,a){Object.entries(t.attrs3).forEach(([u,f])=>{a.updateAttribute(t,n,u,typeof f=="function"?f(o):f)})},updateStyles:function(n,t,o,a){Object.entries(t.updateStyles(o)).forEach(([u,f])=>{typeof f=="object"?a.animateCSS(n,u,f):n.style.setProperty(u,f)})}}}function Jt(n){let t=[],o=Ii();return n.updateAttrs&&t.push(o.updateAttrs),n.attrs3&&t.push(o.attrs3),n.updateStyles&&t.push(o.updateStyles),t}var rs=(...n)=>n.filter(t=>typeof t=="function").reduce((t,o)=>t===null?o:function(...u){t.apply(this,u),o.apply(this,u)},null);var Ni={createElementHTML:Hr,createElementSVG:Kr,createElement:st,Enter_Children:Ye,UPDATE_Chidldren:Tt,Update_Tag:Vt,animateAttr:ot,animateCSS:qt,enterProps:Wt,enterAttribute:ss,updateProps:Jt,updateAttribute:ns},ye=Ni;function ss(n,t,o,a){if(o==="class"){var u=a||void 0;t._attrsV[o]=u,u&&(t._attrsV[o]=u,n.svg?t.setAttribute(o,u):t.className=u)}else o=="id"?(t._attrsV[o]=a,t.id=a,t.setAttribute(o,a)):vt(n.tag,o)?n.tag==="input"&&n.attrs2.type==="radio"&&o==="checked"&&!n.attrsB[o]?a&&(t.setAttribute(o,""),t._attrsV[o]=a):(t._attrsV[o]=a&&!0,a&&t.setAttribute(o,"")):n.tag==="textarea"&&o==="value"?(t._attrsV[o]=a,t.innerHTML=a):(t._attrsV[o]=a,t.setAttribute(o,a))}function Ri(){return{enterAttrs:function(n,t,o,a){Object.entries(t.enterAttrs(o)).forEach(([u,f])=>{if(Array.isArray(f))throw"not implemented";typeof f=="object"?a.animateAttr(n,u,f):a.enterAttribute(t,n,u,f)})},attrs:function(n,t,o,a){var u=t.attrs?t.attrs(o):{};t.attrs2&&Object.entries(t.attrs2).forEach(([f,y])=>{u[f]=typeof y=="function"?y(o):y}),Object.entries(u).forEach(([f,y])=>{a.enterAttribute(t,n,f,y)})},enterStyles:function(n,t,o,a){Object.entries(t.enterStyles(o)).forEach(([u,f])=>{if(Array.isArray(f))throw"not implemented";typeof f=="object"?a.animateCSS(n,u,f):n.style.setProperty(u,f)})},style:function(n,t,o,a){Object.entries(t.style(o)).forEach(([u,f])=>{n.style.setProperty(u,f)})},events:function(n,t,o,a){n.__datum={...o},Object.entries(t.events).map(([u,f])=>{n["on"+u]=y=>f(n.__datum,y)})}}}function Wt(n){let t=[],o=Ri();return n.enterAttrs&&t.push(o.enterAttrs),(n.attrs||n.attrs2)&&t.push(o.attrs),n.enterStyles&&t.push(o.enterStyles),n.style&&t.push(o.style),n.events&&t.push(o.events),t}function os(n){return(t,o,a,u,f,y,_)=>{var E={},w=new Map,N=[],F=a;return y.forEach((D,te)=>{if(t.svg){var I=document.createElementNS("http://www.w3.org/2000/svg",t.tag);Object.assign(I,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}else{var I=document.createElement(t.tag);Object.assign(I,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}I.key=t.key(D),E[I.key]=!0,N.push(I),u[t.loop_alias]=D,t.loop_key_alias&&(u[t.loop_key_alias]=te),t.enterProps&&t.enterProps(I,t,u,_),t.children?_.Enter_Children(I,t.children,u):t.text&&(typeof t.text=="function"?I.textContent=I.__lastText=t.text(u):I.textContent=I.__lastText=t.text),te===0&&!F?o.prepend(I):F.after(I),F=I}),o.__i__[f]={length:y.length,exit:w,elements:N,keys:E},F}}function Mn(n,t,o,a){t.enterProps&&t.enterProps(n,t,o,a),t.children?Ye(n,t.children,o):typeof t.text=="function"?n.textContent=n.__lastText=t.text(o):n.textContent=n.__lastText=t.text}function as(n,t,o,a,u){return n.element=document.createTextNode(n.content),o?o.after(n.element):t.prepend(n.element),t.__i__[u]={exit:!1},n.element}function is(n){return(t,o,a,u,f,y,_)=>{if(t.svg){var E=document.createElementNS("http://www.w3.org/2000/svg",t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}else{var E=document.createElement(t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}return t.enterProps&&t.enterProps(E,t,u,_),t.text&&(typeof t.text=="function"?E.textContent=E.__lastText=t.text(u):E.textContent=E.__lastText=t.text),a?a.after(E):o.prepend(E),o.__i__[f]={exit:!1},E}}function cs(n){return(t,o,a,u,f,y,_)=>{if(t.svg){var E=document.createElementNS("http://www.w3.org/2000/svg",t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}else{var E=document.createElement(t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}return t.enterProps&&t.enterProps(E,t,u,_),a?a.after(E):o.prepend(E),_.Enter_Children(E,t.children,u),o.__i__[f]={exit:!1},E}}function Ye(n,t,o){n.__i__={};var a;t.forEach((u,f)=>{if(u.if&&!u.if(o)){n.__i__[f]=!1;return}if(u.loop){let y=u.loop(o);if(y.length){a=u.enter(u,n,a,o,f,y,ye);return}else{n.__i__[f]=!1;return}}else{a=u.enter(u,n,a,o,f,void 0,ye);return}})}function ls(n){if(n.tag==="#text"){n.enter=as;return}n.enterProps=Wt(n),n.updateProps=Jt(n),n.Update_Tag=Vt(n),n.loop?n.enter=os(n):n.enter=n.children?cs(n):is(n)}var Bi=Object.getPrototypeOf(async function(){}).constructor,jn=Bi;var ki=["svg","g","path","polygon","rect","circle","line","clipPath","cursor","defs","desc","ellipse","filter","font","glyph","image","text","textPath","animate","animateMotion","animateTransform"];function Un(n,t,o){return n.forEach((a,u)=>{ki.includes(a.tag)&&(a.svg=!0),a.context=[...t],a.loop_alias&&(a.loop=new Function(`return ({ ${a.context.join(",")} }) => ${a.loop_fn}`)(),a.context.push(a.loop_alias),a.loop_key_alias&&a.context.push(a.loop_key_alias)),a.textFn&&(a.text=new Function(`return ({ ${a.context.join(",")} }) => ${a.textFn}`)(),delete a.textFn),a.if&&(a.if=new Function(`return ({ ${a.context.join(",")} }) => ${a.if}`)()),a.events&&Object.entries(a.events).forEach(([f,y])=>{typeof y=="string"&&(a.events[f]=new Function(`return async ({ ${a.context.join(",")} }, event) => ${y}`)())}),a.attrsR&&Object.keys(a.attrsR).length&&Object.entries(a.attrsR).forEach(([f,y])=>{if(a.events||(a.events={}),a.events.input)throw"@input and reactive attr at the same time";a.tag==="input"?f==="value"?a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${y} = event.target.value} `)():f==="checked"&&(a.attrs2.type==="checkbox"?a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${y} = event.target.checked} `)():a.attrs2.type==="radio"&&(a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${y} = event.target.value} `)())):a.tag==="textarea"&&f==="value"&&(a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${y} = event.target.value} `)())}),["style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(f=>{a[f]&&(a[f]=new Function(`return ({ ${a.context.join(",")} }) => ({${a[f]}})`)())}),a.attrs2&&(Object.keys(a.attrs2).length&&(a.attrs3={}),Object.entries(a.attrs2).forEach(([f,y])=>{typeof y=="object"&&y.type==="jsAttribute"&&(a.attrs3[f]=a.attrs2[f]=new Function(`return ({ ${a.context.join(",")} }) => ${y.value+(y.args||"")}`)())}),Object.keys(a.attrs3).length||delete a.attrs3),ls(a),a.children&&Un(a.children,a.context,o)}),n}function Fi(n){return n.filter(t=>{if(t.nodeType==="bracket"){let o=t.innerContent.split(" ").join("");if(["","/","@","@/","/@"].includes(o))throw`Empty tag <${o}>`}return!(t.nodeType==="text"&&!t.content.trim().length)})}function Mi(n=""){return Fi(nt(n,{skip:!0,pairs:["<>","{}","()","[]"]}))}function us(n,t=[],o=!1){return Un(Qr(Wr(Mi(n)),t),["state"],o)}var ji="static|template|state|class|style";function Ui(n){return n.split(/\r\n|\n|\r/)}function Di(n,t){let o=n.match(new RegExp(`^\\s*<!(${t})>\\s*$`,"i"));return o?o[1]:null}function zi(n,t){let o=n.match(new RegExp(`^\\s*<!${t}\\s+([^>]*)>\\s*$`,"i"));return o?o[1]:null}async function Gi(n){let t=Ui(n),o={};var a=void 0,u=0;for(let f=0;f<t.length;f++){let y=t[f];if(!y.trim().length)continue;let _=Di(y,ji+"|walt");if(!(!_&&["css","import","tag"].some(E=>{let w=zi(y,E);if(w)return a=E,o[a]||(o[a]=[]),o[E].push(a==="tag"?{value:w,line:f}:w),!0}))){if(!a&&!_){a="template",u=f,o.template="",o.template+=`
`+y;continue}if(_){if(a=_,!o[_])o[_]="";else throw`duplicate <!${_}> block at line ${f}`;continue}else{if(["css","import","tag"].includes(a))if(!o.template)a="template",u=f,o.template="";else{if(y.trim().startsWith("//"))continue;throw`unexpected "${y.trim()}" at line ${f}. Template started at line ${u}`}o[a]+=`
`+y;continue}}}return o}function at(n){return['"',"'","`"].includes(n[0])&&n[0]==n[n.length-1]?n.substring(1,n.length-1).trim():n.trim()}function Yi(n){let t={},o=_t(n.value," ",!0).map(at);if(o.length>2)throw`excess arguments <!tag ${n.value}> at line ${n.line}`;if(o.some(a=>!a))throw`empty argument <!tag ${n.value}> at line ${n.line}`;if(o.length===1){if(o[0][0]==="@")throw`alias is present but path is not <!tag ${n.value}> at line ${n.line}`;t.alias="@"+o[0].split("\\").pop().split("/").pop(),t.path=o[0]}else{if(o[0][0]!=="@")throw`missing alias identifier "@" <!tag ${n.value}> at line ${n.line}`;t.alias=o[0],t.path=o[1]}return t}function qi(n){if(_t(n," ",!0).length>1)throw`excess parameters <!import ${n}>`;return at(n)}function Qt(n){try{Function("var "+n)}catch(t){return!1}return!0}function Vi(n){let t=_t(n," ",!0);if(t.length<3)throw`not enough parameters <!import ${n}>`;if(t.length===3){if(t[1].toLowerCase()!=="from")throw`wrong parameters <!import ${n}>`;if(t[0].startsWith("{")&&t[0].endsWith("}")){let a=t[0].substring(1,t[0].length-1);if(!a.length)throw`wrong parameters <!import ${n}>`;if(!a.split(",").map(f=>f.trim()).every(Qt))throw`invalid variable name <!import ${n}>`;return{type:"object",import:t[0],path:at(t[2])}}else{if(!Qt(t[0]))throw`invalid variable name <!import ${n}>`;return{type:"var",import:t[0],path:at(t[2])}}}else{try{var o=nt(n,{pairs:["{}"]})}catch(a){throw`invalid variable name <!import ${n}>`}if(o.length>2)throw`wrong parameters <!import ${n}>`;if(o.length===1){if(o[0].nodeType==="bracket")throw`wrong parameters <!import ${n}>`;if(t[0]==="*"&&t[1].toLowerCase()==="as"&&t[3].toLowerCase()==="from"&&t.length===5){if(!Qt(t[2]))throw`invalid variable name <!import ${n}>`;return{type:"*",import:t[2],path:at(t[4])}}else throw`wrong parameters <!import ${n}>`}else{let a=_t(o[1].content," ",!0);if(a.length!==2||a[0].toLowerCase()!=="from")throw`wrong parameters <!import ${n}>`;if(!o[0].innerContent.trim().length)throw`wrong parameters <!import ${n}>`;let u=o[0].innerContent.split(",").map(f=>f.trim());if(!u.every(Qt))throw`invalid variable name <!import ${n}>`;return{type:"object",import:"{"+u.join(",")+"}",path:at(a[1])}}}}async function ps(n){let t=await Gi(n);return t.tag&&(t.tag=t.tag.map(Yi)),t.css&&(t.css=t.css.map(qi)),t.import&&(t.import=t.import.map(Vi)),t}function Ji(n){return["Update_Tag","enterProps","updateProps"].forEach(t=>{Array.isArray(n[t])&&(n[t].length?n[t]=rs(...n[t]):delete n[t])}),n}function Dn(n){n.forEach((t,o)=>{n[o]=Ji(t),t.children&&Dn(t.children)})}var Ht=n=>class extends n{connectedCallback(){Ye(this.document,this.component,{state:this.state}),this.__proto__.setAttribute=Wi,delete this.__proto__.initialize,this.is_connected=!0,this.connected&&setTimeout(()=>{this.connected()},0)}disconnectedCallback(){this.disconnected&&this.disconnected()}render(){this.is_connected&&Tt(this.document,this.component,{state:this.state})}setAttribute(o,a){this.state[o]=a}initialize(){if(this.component=this.initial_component,Dn(this.component),this.window_events={},this.css.length){let o=document.createElement("style");o.textContent=this.css,this.document.append(o)}}get cookies(){return typeof document<"u"?Object.assign({},...document.cookie.split(";").filter(o=>o).map(o=>o.split("=")).map(([o,a])=>({[o.trim()]:(a+"").trim()}))):{}}get hash(){return typeof window<"u"?window.location.hash.substr(1).split("/"):[]}get slotted(){let o=this.document.querySelector("slot");return o?o.assignedElements():[]}emitNative(o,a){this.dispatchEvent(new CustomEvent(o,{cancelable:!1,bubbles:!1,detail:a}))}on(o,a,u){this.window_events[o]||(this.window_events[o]=[]);let f=this.window_events[o].find(_=>_.callback===a),y=(..._)=>a.call(this,..._);f||(this.window_events[o].push({callback:a,cb:y}),window.addEventListener(o,y,u))}off(o,a){if(!this.window_events[o])return;let u=this.window_events[o].findIndex(f=>f.callback===a);u!==-1&&(window.removeEventListener(o,this.window_events[o][u].cb),this.window_events[o].splice(u,1))}};function Wi(n,t){this.state[n]=t,this.changed&&this.changed({[n]:t}),setTimeout(()=>{Tt(this.document,this.component,{state:this.state})},0)}var Qi=function(n){"use strict";var t=a,o=Object.prototype.hasOwnProperty;function a(){for(var s={},e=0;e<arguments.length;e++){var r=arguments[e];for(var i in r)o.call(r,i)&&(s[i]=r[i])}return s}let u=s=>s;function f(s){function e(r){if(!Array.isArray(r))throw new Error("Transform must be used on an Array. Received "+JSON.stringify(r));let i=(()=>{let[h]=r;return h.Type in s&&typeof s[h.Type]=="function"?s[h.Type]:u})();if(i.length===2)return i(r,e);let[c,...l]=i(r),m=c.params.filter(Boolean).map(h=>e([h,...l]));return t(c,{params:m})}return e}function y(s){let e=r=>{if(r==null)return r;let i=(()=>"*"in s&&typeof s["*"]=="function"?s["*"]:r.Type in s&&typeof s[r.Type]=="function"?s[r.Type]:u)();if(i.length===2)return i(r,e);let c=i(r),l=c.params.map(e);return t(c,{params:l})};return e}var _={map:f,mapNode:y},E=_,w=E.map,N=E.mapNode,F=function(s){let e=r=>{if(r==null)return r;let{params:i}=r,c=(()=>"*"in s&&typeof s["*"]=="function"?s["*"]:r.Type in s&&typeof s[r.Type]=="function"?s[r.Type]:()=>r)();return c.length===2?(c(r,e),r):(c(r),i.forEach(e),r)};return e},D=F,te=function(s,e,r,i,c,l,m,h){if(e===void 0)throw new Error("invariant requires an error message argument");if(!s){var p;if(e===void 0)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[r,i,c,l,m,h],b=0;p=new Error(e.replace(/%s/g,function(){return v[b++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}},I=te,ve=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(s){return s&&s.__esModule?s.default:s}function re(s,e){return e={exports:{}},s(e,e.exports),e.exports}var J=re(function(s,e){(function(r,i){i(e)})(ve,function(r){let i={whitespace:/[ \t]+/,comment:[{match:/\/\/.*?$/},{match:/\/\*[^]*?\*\//,lineBreaks:!0}],number:[{match:/0[xX][0-9a-fA-F]+/},{match:/0[oO][0-9]+/},{match:/0[bB][01]+/},{match:/(?:[0-9]+(?:\.[0-9]+)?e-?[0-9]+)/},{match:/[0-9]+\.[0-9]+|[0-9]+/}],char:[{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])'/,value:ze=>ze.slice(1,-1)}],string:[{match:/"(?:\\["\\rn]|[^"\\\n])*?"/,value:ze=>ze.slice(1,-1)},{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])*?'/,value:ze=>ze.slice(1,-1)},{match:/`(?:\\['\\bfnrtv0]|[^'\\])*?`/,value:ze=>ze.slice(1,-1)}],identifier:{match:/[A-Za-z_$][A-Za-z0-9_$]*/,keywords:{keyword:["break","if","else","import","as","from","export","return","switch","case","default","const","let","for","continue","do","while","throw","function","global","module","type","lambda"],type:["i32","i64","f32","f64","bool"]}},punctuator:["+","++","-","--",">>",">>>","<<","=","==","+=","-=","=>","<=",">=","!=","%","*","/","^","&","~","|","!","**",":","(",")",".","{","}",",","[","]",";",">","<","?","||","&&","{","}","..."],newline:{match:/(?:\r\n|\r|\n)/,lineBreaks:!0}},c="Program",l="Keyword",m="Export",h="Import",p="Statement",v="IfThenElse",b="Select",g="Else",A="UnaryExpression",L="BinaryExpression",R="TernaryExpression",M="NumberLiteral",z="StringLiteral",X="CharacterLiteral",Q="Punctuator",$e="Identifier",pe="ArraySubscript",C="Constant",j="Type",U="ArrayType",Y="DeclType",q="GenericType",V="UserType",H="FunctionType",Z="Declaration",ee="StaticDeclaration",ae="StaticValueList",_e="ImmutableDeclaration",ge="FunctionDeclaration",me="ArrayDeclaration",tt="IndirectFunctionCall",dt="FunctionCall",De="Loop",bt="MemoryAssignment",ie="Assignment",xr="AssignmentExpression",Ar="Param",_n="Typedef",gn="Struct",vn="UnionType",Sn="ReturnStatement",Tn="Sequence",En="ObjectLiteral",xn="Pair",wr="TypeCast",An="Break",wn="Comment",$n="Sizeof",Cn="Spread",$r="Closure",On="Noop",Cr="ClosureType",Ln="Block",Or="ObjectField",Lr="FunctionIndex",Pr="FunctionIdentifier",Ir="FunctionPointer",Nr="FunctionArguments",Rr="FunctionResult",Br="FunctionLocals",kr="NativeMethod",Pn="Unreachable",Fr="Access",Mr="i32",jr="f32",Ur="i64",Dr="f64",zr="Memory",Gr="Table",Yr="bool";r.Program=c,r.Keyword=l,r.Export=m,r.Import=h,r.Statement=p,r.IfThenElse=v,r.Select=b,r.Else=g,r.UnaryExpression=A,r.BinaryExpression=L,r.TernaryExpression=R,r.NumberLiteral=M,r.StringLiteral=z,r.CharacterLiteral=X,r.Punctuator=Q,r.Identifier=$e,r.ArraySubscript=pe,r.Constant=C,r.Type=j,r.ArrayType=U,r.DeclType=Y,r.GenericType=q,r.UserType=V,r.FunctionType=H,r.Declaration=Z,r.StaticDeclaration=ee,r.StaticValueList=ae,r.ImmutableDeclaration=_e,r.FunctionDeclaration=ge,r.ArrayDeclaration=me,r.IndirectFunctionCall=tt,r.FunctionCall=dt,r.Loop=De,r.MemoryAssignment=bt,r.Assignment=ie,r.AssignmentExpression=xr,r.Param=Ar,r.Typedef=_n,r.Struct=gn,r.UnionType=vn,r.ReturnStatement=Sn,r.Sequence=Tn,r.ObjectLiteral=En,r.Pair=xn,r.TypeCast=wr,r.Break=An,r.Comment=wn,r.Sizeof=$n,r.Spread=Cn,r.Closure=$r,r.Noop=On,r.ClosureType=Cr,r.Block=Ln,r.ObjectField=Or,r.FunctionIndex=Lr,r.FunctionIdentifier=Pr,r.FunctionPointer=Ir,r.FunctionArguments=Nr,r.FunctionResult=Rr,r.FunctionLocals=Br,r.NativeMethod=kr,r.Unreachable=Pn,r.Access=Fr,r.i32=Mr,r.f32=jr,r.i64=Ur,r.f64=Dr,r.Memory=zr,r.Table=Gr,r.bool=Yr,r.builtinTypes={i32:Mr,f32:jr,i64:Ur,f64:Dr,Memory:zr,Table:Gr,bool:Yr},r.statements={Program:c,Export:m,Import:h,IfThenElse:v,Else:g,Declaration:Z,ImmutableDeclaration:_e,FunctionDeclaration:ge,ArrayDeclaration:me,Loop:De,MemoryAssignment:bt,Assignment:ie,Typedef:_n,Struct:gn,UnionType:vn,ReturnStatement:Sn,Sequence:Tn,ObjectLiteral:En,Pair:xn,Break:An,Comment:wn,Sizeof:$n,Spread:Cn,Noop:On,Block:Ln,Unreachable:Pn},r.default={Program:c,Keyword:l,Export:m,Import:h,Statement:p,IfThenElse:v,Select:b,Else:g,UnaryExpression:A,BinaryExpression:L,TernaryExpression:R,NumberLiteral:M,StringLiteral:z,CharacterLiteral:X,Punctuator:Q,Identifier:$e,ArraySubscript:pe,Constant:C,Type:j,ArrayType:U,DeclType:Y,GenericType:q,UserType:V,FunctionType:H,Declaration:Z,ImmutableDeclaration:_e,FunctionDeclaration:ge,ArrayDeclaration:me,StaticDeclaration:ee,StaticValueList:ae,IndirectFunctionCall:tt,FunctionCall:dt,Loop:De,MemoryAssignment:bt,Assignment:ie,AssignmentExpression:xr,Param:Ar,Typedef:_n,Struct:gn,UnionType:vn,ReturnStatement:Sn,Sequence:Tn,ObjectLiteral:En,Pair:xn,TypeCast:wr,Break:An,Comment:wn,Sizeof:$n,Spread:Cn,Closure:$r,Access:Fr,Noop:On,ClosureType:Cr,Block:Ln,ObjectField:Or,FunctionIndex:Lr,FunctionIdentifier:Pr,FunctionPointer:Ir,FunctionArguments:Nr,FunctionResult:Rr,FunctionLocals:Br,NativeMethod:kr,Unreachable:Pn},r.tokens=i,Object.defineProperty(r,"__esModule",{value:!0})})}),d=ne(J),be=J.tokens,Ce=J.semantics,he=J.builtinTypes,ut=J.statements,pt=J.i32,Me=J.f32,ic=J.i64,cc=J.f64,As=re(function(s){(function(e,r){s.exports?s.exports=r():e.moo=r()})(ve,function(){var e=Object.prototype.hasOwnProperty,r=typeof Object.assign=="function"?Object.assign:function(C,j){if(C==null)throw new TypeError("Target cannot be null or undefined");C=Object(C);for(var U=1;U<arguments.length;U++){var Y=arguments[U];if(Y!=null)for(var q in Y)e.call(Y,q)&&(C[q]=Y[q])}return C},i=typeof new RegExp().sticky=="boolean";function c(C){return C&&C.constructor===RegExp}function l(C){return C&&typeof C=="object"&&C.constructor!==RegExp&&!Array.isArray(C)}function m(C){return C.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function h(C){var j=new RegExp("|"+C);return j.exec("").length-1}function p(C){return"("+C+")"}function v(C){var j=C.map(function(U){return"(?:"+U+")"}).join("|");return"(?:"+j+")"}function b(C){if(typeof C=="string")return"(?:"+m(C)+")";if(c(C)){if(C.ignoreCase)throw new Error("RegExp /i flag not allowed");if(C.global)throw new Error("RegExp /g flag is implied");if(C.sticky)throw new Error("RegExp /y flag is implied");if(C.multiline)throw new Error("RegExp /m flag is implied");return C.source}else throw new Error("not a pattern: "+C)}function g(C){for(var j=Object.getOwnPropertyNames(C),U=[],Y=0;Y<j.length;Y++){var q=j[Y],V=C[q],H=Array.isArray(V)?V:[V],Z=[];H.forEach(function(ee){l(ee)?(Z.length&&U.push(L(q,Z)),U.push(L(q,ee)),Z=[]):Z.push(ee)}),Z.length&&U.push(L(q,Z))}return U}function A(C){for(var j=[],U=0;U<C.length;U++){var Y=C[U];if(!Y.name)throw new Error("Rule has no name: "+JSON.stringify(Y));j.push(L(Y.name,Y))}return j}function L(C,j){(typeof j!="object"||Array.isArray(j)||c(j))&&(j={match:j});var U=r({tokenType:C,lineBreaks:!!j.error,pop:!1,next:null,push:null,error:!1,value:null,getType:null},j),Y=U.match;return U.match=Array.isArray(Y)?Y:Y?[Y]:[],U.match.sort(function(q,V){return c(q)&&c(V)?0:c(V)?-1:c(q)?1:V.length-q.length}),U.keywords&&(U.getType=X(U.keywords)),U}function R(C,j){C=Array.isArray(C)?A(C):g(C);for(var U=null,Y=[],q=[],V=0;V<C.length;V++){var H=C[V];if(H.error){if(U)throw new Error("Multiple error rules not allowed: (for token '"+H.tokenType+"')");U=H}if(H.match.length!==0){Y.push(H);var Z=v(H.match.map(b)),ee=new RegExp(Z);if(ee.test(""))throw new Error("RegExp matches empty string: "+ee);var ae=h(Z);if(ae>0)throw new Error("RegExp has capture groups: "+ee+`
Use (?: \u2026 ) instead`);if(!j&&(H.pop||H.push||H.next))throw new Error("State-switching options are not allowed in stateless lexers (for token '"+H.tokenType+"')");if(!H.lineBreaks&&ee.test(`
`))throw new Error("Rule should declare lineBreaks: "+ee);q.push(p(Z))}}var _e=i?"":"|(?:)",ge=i?"ym":"gm",me=new RegExp(v(q)+_e,ge);return{regexp:me,groups:Y,error:U}}function M(C){var j=R(C);return new Q({start:j},"start")}function z(C,j){var U=Object.getOwnPropertyNames(C);j||(j=U[0]);for(var Y=Object.create(null),q=0;q<U.length;q++){var V=U[q];Y[V]=R(C[V],!0)}for(var q=0;q<U.length;q++)for(var H=Y[U[q]].groups,Z=0;Z<H.length;Z++){var ee=H[Z],ae=ee&&(ee.push||ee.next);if(ae&&!Y[ae])throw new Error("Missing state '"+ae+"' (in token '"+ee.tokenType+"' of state '"+U[q]+"')");if(ee&&ee.pop&&+ee.pop!=1)throw new Error("pop must be 1 (in token '"+ee.tokenType+"' of state '"+U[q]+"')")}return new Q(Y,j)}function X(C){for(var j=Object.create(null),U=Object.create(null),Y=Object.getOwnPropertyNames(C),q=0;q<Y.length;q++){var V=Y[q],H=C[V],Z=Array.isArray(H)?H:[H];Z.forEach(function(me){if((U[me.length]=U[me.length]||[]).push(me),typeof me!="string")throw new Error("keyword must be string (in keyword '"+V+"')");j[me]=V})}function ee(me){return JSON.stringify(me)}var ae="";ae+=`(function(value) {
`,ae+=`switch (value.length) {
`;for(var _e in U){var ge=U[_e];ae+="case "+_e+`:
`,ae+=`switch (value) {
`,ge.forEach(function(me){var tt=j[me];ae+="case "+ee(me)+": return "+ee(tt)+`
`}),ae+=`}
`}return ae+=`}
`,ae+="})",(0,eval)(ae)}var Q=function(C,j){this.startState=j,this.states=C,this.buffer="",this.stack=[],this.reset()};Q.prototype.reset=function(C,j){return this.buffer=C||"",this.index=0,this.line=j?j.line:1,this.col=j?j.col:1,this.setState(j?j.state:this.startState),this},Q.prototype.save=function(){return{line:this.line,col:this.col,state:this.state}},Q.prototype.setState=function(C){if(!(!C||this.state===C)){this.state=C;var j=this.states[C];this.groups=j.groups,this.error=j.error||{lineBreaks:!0,shouldThrow:!0},this.re=j.regexp}},Q.prototype.popState=function(){this.setState(this.stack.pop())},Q.prototype.pushState=function(C){this.stack.push(this.state),this.setState(C)},Q.prototype._eat=i?function(C){return C.exec(this.buffer)}:function(C){var j=C.exec(this.buffer);return j[0].length===0?null:j},Q.prototype._getGroup=function(C){if(C===null)return-1;for(var j=this.groups.length,U=0;U<j;U++)if(C[U+1]!==void 0)return U;throw new Error("oops")};function $e(){return this.value}if(Q.prototype.next=function(){var C=this.re,j=this.buffer,U=C.lastIndex=this.index;if(U!==j.length){var Y=this._eat(C),q=this._getGroup(Y),V,H;q===-1?(V=this.error,H=j.slice(U)):(H=Y[0],V=this.groups[q]);var Z=0;if(V.lineBreaks){var ee=/\n/g,ae=1;if(H===`
`)Z=1;else for(;ee.exec(H);)Z++,ae=ee.lastIndex}var _e={type:V.getType&&V.getType(H)||V.tokenType,value:V.value?V.value(H):H,text:H,toString:$e,offset:U,lineBreaks:Z,line:this.line,col:this.col},ge=H.length;if(this.index+=ge,this.line+=Z,Z!==0?this.col=ge-ae+1:this.col+=ge,V.shouldThrow)throw new Error(this.formatError(_e,"invalid syntax"));return V.pop?this.popState():V.push?this.pushState(V.push):V.next&&this.setState(V.next),_e}},typeof Symbol<"u"&&Symbol.iterator){var pe=function(C){this.lexer=C};pe.prototype.next=function(){var C=this.lexer.next();return{value:C,done:!C}},pe.prototype[Symbol.iterator]=function(){return this},Q.prototype[Symbol.iterator]=function(){return new pe(this)}}return Q.prototype.formatError=function(C,j){var U=C.value,Y=C.offset,q=C.lineBreaks?U.indexOf(`
`):U.length,V=Math.max(0,Y-C.col+1),H=this.buffer.substring(V,Y+q);return j+=" at line "+C.line+" col "+C.col+`:

`,j+="  "+H+`
`,j+="  "+Array(C.col).join(" ")+"^",j},Q.prototype.clone=function(){return new Q(this.states,this.state)},Q.prototype.has=function(C){for(var j in this.states)for(var U=this.states[j].groups,Y=0;Y<U.length;Y++){var q=U[Y];if(q.tokenType===C||q.keywords&&e.call(q.keywords,C))return!0}return!1},{compile:M,states:z,error:Object.freeze({error:!0})}})}),Wn=Array.prototype.slice,ws=function(s){return Wn.call(s)},$s=function(s){return Wn.call(s,1)},Xt=function(s,e,r){var i=r-e.length;switch(i){case 0:return function(){return Ae(s,xe(e,arguments),r)};case 1:return function(c){return Ae(s,xe(e,arguments),r)};case 2:return function(c,l){return Ae(s,xe(e,arguments),r)};case 3:return function(c,l,m){return Ae(s,xe(e,arguments),r)};case 4:return function(c,l,m,h){return Ae(s,xe(e,arguments),r)};case 5:return function(c,l,m,h,p){return Ae(s,xe(e,arguments),r)};case 6:return function(c,l,m,h,p,v){return Ae(s,xe(e,arguments),r)};case 7:return function(c,l,m,h,p,v,b){return Ae(s,xe(e,arguments),r)};case 8:return function(c,l,m,h,p,v,b,g){return Ae(s,xe(e,arguments),r)};case 9:return function(c,l,m,h,p,v,b,g,A){return Ae(s,xe(e,arguments),r)};case 10:return function(c,l,m,h,p,v,b,g,A,L){return Ae(s,xe(e,arguments),r)};default:return Cs(s,e,i)}},xe=function(s,e){return s.concat(ws(e))},Cs=function(s,e,r){var i=Os(r),c="false||function("+i+"){ return processInvocation(fn, concatArgs(args, arguments)); }";return(0,eval)(c)},Os=function(s){for(var e=[],r=0;r<s;r+=1)e.push("a"+r.toString());return e.join(",")},Ls=function(s,e){return s.length>e?s.slice(0,e):s},Ae=function(s,e,r){return e=Ls(e,r),e.length===r?s.apply(null,e):Xt(s,e,r)},Re=function(s){return Xt(s,[],s.length)};Re.to=Re(function(s,e){return Xt(e,[],s)}),Re.adaptTo=Re(function(s,e){return Re.to(s,function(r){var i=$s(arguments).concat(r);return e.apply(this,i)})}),Re.adapt=function(s){return Re.adaptTo(s.length,s)};var At=Re;function B(s){return s[0]}function Ps(){let s=this.lexer,e=this.Syntax,{extendNode:r,drop:i,nth:c,nuller:l,nonEmpty:m,add:h,flatten:p,compose:v}=this.helpers,{node:b,binary:g,constant:A,identifier:L,statement:R,unary:M,ternary:z,subscript:X,access:Q,fun:$e,declaration:pe,call:C,struct:j,result:U,string:Y,char:q,typedef:V,voidFun:H,type:Z,arrayType:ee,assignment:ae,forLoop:_e,whileLoop:ge,typeGeneric:me,spread:tt,builtinDecl:dt,assignmentExpr:De,addressOf:bt}=this.nodes(s);return{Lexer:s,ParserRules:[{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","wschar"],postprocess:function(ie){return ie[0].concat([ie[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(ie){return null}},{name:"__$ebnf$1",symbols:["wschar"]},{name:"__$ebnf$1",symbols:["__$ebnf$1","wschar"],postprocess:function(ie){return ie[0].concat([ie[1]])}},{name:"__",symbols:["__$ebnf$1"],postprocess:function(ie){return null}},{name:"wschar",symbols:[/[ \t\n\v\f]/],postprocess:B},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","Union","SEPARATOR"],postprocess:j},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","NativeType","SEPARATOR"],postprocess:j},{name:"Union",symbols:["StructDefinition"],postprocess:B},{name:"Union",symbols:["StructDefinition","_","OR","_","Union"],postprocess:b(e.UnionType)},{name:"StructDefinition",symbols:["ArrayType"],postprocess:B},{name:"StructDefinition",symbols:["Identifier"],postprocess:B},{name:"StructDefinition",symbols:["LCB","_","StructBody","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"StructBody",symbols:["StructNameAndType"],postprocess:B},{name:"StructBody",symbols:["StructNameAndType","_","COMMA","_","StructBody"],postprocess:p},{name:"StructNameAndType",symbols:["Identifier","_","COLON","_","Type"],postprocess:b(e.Pair)},{name:"StructNameAndType",symbols:["AddressOf","_","COLON","_","Type"],postprocess:b(e.Pair)},{name:"AddressOf",symbols:["AND","Identifier"],postprocess:bt},{name:"TypeDef",symbols:["TYPE","__","Identifier","_","EQUALS","_","TypeDefinition","_","FATARROW","_","Type","_","SEPARATOR"],postprocess:v(V)},{name:"TypeDefinition",symbols:["LB","_","TypeList","_","RB"],postprocess:p},{name:"TypeDefinition",symbols:["LB","_","RB"],postprocess:p},{name:"TypeList",symbols:["Type"],postprocess:B},{name:"TypeList",symbols:["Type","_","COMMA","_","TypeList"],postprocess:p},{name:"_Type",symbols:["NativeType"],postprocess:B},{name:"_Type",symbols:["GenericType"],postprocess:B},{name:"_Type",symbols:["Identifier"],postprocess:B},{name:"ArrayType",symbols:["_Type","_","LSB","_","RSB"],postprocess:ee},{name:"Type",symbols:["_Type"],postprocess:B},{name:"Type",symbols:["ArrayType"],postprocess:B},{name:"GenericType",symbols:["Identifier","LT","_","StaticObjectLiteral","_","GT"],postprocess:me},{name:"StaticObjectLiteral",symbols:["LCB","_","RCB"],postprocess:v(b(e.ObjectLiteral))},{name:"StaticObjectLiteral",symbols:["LCB","_","StaticPropertyList","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"StaticPropertyValue",symbols:["Number"],postprocess:B},{name:"StaticPropertyValue",symbols:["Boolean"],postprocess:B},{name:"StaticPropertyValue",symbols:["StringLiteral"],postprocess:B},{name:"StaticProperty",symbols:["Identifier","_","COLON","_","StaticPropertyValue"],postprocess:b(e.Pair)},{name:"StaticPropertyList",symbols:["StaticProperty"],postprocess:B},{name:"StaticPropertyList",symbols:["StaticProperty","_","COMMA","_","StaticPropertyList"],postprocess:p},{name:"ObjectLiteral",symbols:["LCB","_","RCB"],postprocess:b(e.ObjectLiteral)},{name:"ObjectLiteral",symbols:["LCB","_","PropertyList","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"PropertyList",symbols:["Property"],postprocess:B},{name:"PropertyList",symbols:["Property","_","COMMA","_","PropertyList"],postprocess:p},{name:"Property",symbols:["Identifier","_","COLON","_","Ternary"],postprocess:b(e.Pair)},{name:"Property",symbols:["SPREAD","Identifier"],postprocess:tt},{name:"Property",symbols:["Identifier"],postprocess:B},{name:"Import",symbols:["IMPORT","_","ImportDefinition","__","FROM","__","StringLiteral","_","SEPARATOR"],postprocess:b(e.Import)},{name:"ImportDefinition",symbols:["LCB","_","ImportAndTypeList","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"ImportAndTypeList",symbols:["ImportName"],postprocess:B},{name:"ImportAndTypeList",symbols:["ImportAndType"],postprocess:B},{name:"ImportAndTypeList",symbols:["ImportName","_","COMMA","_","ImportAndTypeList"],postprocess:p},{name:"ImportAndTypeList",symbols:["ImportAndType","_","COMMA","_","ImportAndTypeList"],postprocess:p},{name:"ImportAndType",symbols:["ImportName","_","COLON","_","Type"],postprocess:b(e.Pair)},{name:"ImportAndType",symbols:["ImportName","_","AS","_","Identifier"],postprocess:b(e.BinaryExpression,{value:"as"})},{name:"ImportAndType",symbols:["ImportAndType","_","AS","_","Identifier"],postprocess:b(e.BinaryExpression,{value:"as"})},{name:"ImportName",symbols:["Identifier"],postprocess:B},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:b(e.IfThenElse)},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody","_","Else"],postprocess:b(e.IfThenElse)},{name:"Else",symbols:["ELSE","_","BranchBody"],postprocess:b(e.Else)},{name:"BranchBody",symbols:["Statement"],postprocess:B},{name:"BranchBody",symbols:["Block"],postprocess:B},{name:"For",symbols:["FOR","_","LB","_","ForArg","_","SEPARATOR","_","Expression","_","SEPARATOR","_","ForArg","_","RB","_","BranchBody"],postprocess:_e},{name:"ForArg",symbols:["_Assignment"],postprocess:B},{name:"ForArg",symbols:["Ternary"],postprocess:B},{name:"While",symbols:["WHILE","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:ge},{name:"Break",symbols:["BREAK","_","SEPARATOR"],postprocess:b(e.Break)},{name:"Program",symbols:["_"],postprocess:v(b("Program",{value:"ROOT_NODE"}),p)},{name:"Program",symbols:["_","SourceElementList","_"],postprocess:v(b("Program",{value:"ROOT_NODE"}),p)},{name:"SourceElementList",symbols:["SourceElement"],postprocess:p},{name:"SourceElementList",symbols:["SourceElement","_","SourceElementList"],postprocess:v(i,p,p)},{name:"SourceElement",symbols:["Function"],postprocess:B},{name:"SourceElement",symbols:["GlobalDeclaration"],postprocess:B},{name:"SourceElement",symbols:["GlobalImmutableDeclaration"],postprocess:B},{name:"SourceElement",symbols:["StaticDeclaration"],postprocess:B},{name:"SourceElement",symbols:["Struct"],postprocess:B},{name:"SourceElement",symbols:["TypeDef"],postprocess:B},{name:"SourceElement",symbols:["Export"],postprocess:B},{name:"SourceElement",symbols:["Import"],postprocess:B},{name:"Statement",symbols:["ExpressionStatement"],postprocess:B},{name:"Statement",symbols:["Declaration"],postprocess:B},{name:"Statement",symbols:["ImmutableDeclaration"],postprocess:B},{name:"Statement",symbols:["Assignment"],postprocess:B},{name:"Statement",symbols:["If"],postprocess:B},{name:"Statement",symbols:["For"],postprocess:B},{name:"Statement",symbols:["While"],postprocess:B},{name:"Statement",symbols:["Break"],postprocess:B},{name:"Statement",symbols:["Unreachable"],postprocess:B},{name:"Statement",symbols:["ReturnStatement"],postprocess:B},{name:"Block",symbols:["LCB","_","RCB"],postprocess:b(e.Block)},{name:"Block",symbols:["LCB","_","StatementList","_","RCB"],postprocess:v(b(e.Block),p)},{name:"StatementList",symbols:["Statement"],postprocess:i},{name:"StatementList",symbols:["Statement","_","StatementList"],postprocess:p},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","Block"],postprocess:H},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","FunctionResult","_","Block"],postprocess:$e},{name:"FunctionParameters",symbols:["LB","_","RB"],postprocess:b(e.FunctionArguments)},{name:"FunctionParameters",symbols:["LB","_","ParameterList","_","RB"],postprocess:v(b(e.FunctionArguments),p,p)},{name:"ParameterList",symbols:["NameAndType"],postprocess:B},{name:"ParameterList",symbols:["NameAndType","_","COMMA","_","ParameterList"],postprocess:p},{name:"NameAndType",symbols:["Identifier","_","COLON","_","DeclType"],postprocess:b(e.Pair)},{name:"DeclType",symbols:["Type"],postprocess:v(r({Type:e.DeclType}),c(0))},{name:"FunctionResult",symbols:["COLON","_","Type"],postprocess:v(U,i)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:dt},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:dt},{name:"StaticNameAndType",symbols:["Identifier","_","COLON","_","ArrayType"],postprocess:b(e.Pair)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","RSB","_","SEPARATOR"],postprocess:pe(e.StaticDeclaration)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","StaticValueList","_","RSB","_","SEPARATOR"],postprocess:v(pe(e.StaticDeclaration),p)},{name:"StaticValueList",symbols:["Atom"],postprocess:B},{name:"StaticValueList",symbols:["Atom","_","COMMA","_","StaticValueList"],postprocess:p},{name:"Unreachable",symbols:["THROW","_","SEPARATOR"],postprocess:b(e.Unreachable)},{name:"Unreachable",symbols:["THROW","_","Expression","_","SEPARATOR"],postprocess:b(e.Unreachable)},{name:"Pair",symbols:["Identifier","_","COLON","_","Identifier"],postprocess:b(e.Pair)},{name:"Export",symbols:["EXPORT","__","ImmutableDeclaration"],postprocess:b(e.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Function"],postprocess:b(e.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","TypeDef"],postprocess:b(e.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Struct"],postprocess:b(e.Export,{value:"export"})},{name:"ReturnStatement",symbols:["RETURN","__","Expression","_","SEPARATOR"],postprocess:b(e.ReturnStatement)},{name:"ReturnStatement$subexpression$1",symbols:[{literal:";"}],postprocess:l},{name:"ReturnStatement",symbols:["RETURN","ReturnStatement$subexpression$1"],postprocess:b(e.ReturnStatement)},{name:"Assignment",symbols:["_Assignment","_","SEPARATOR"],postprocess:B},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","Expression"],postprocess:ie=>ae(ie,"=")},{name:"_Assignment",symbols:["Subscript","_","PLSEQUALS","_","Expression"],postprocess:ie=>ae(ie,"+=")},{name:"_Assignment",symbols:["Subscript","_","MINEQUALS","_","Expression"],postprocess:ie=>ae(ie,"-=")},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","ObjectLiteral"],postprocess:ie=>ae(ie,"=")},{name:"ExpressionStatement",symbols:["Call","_","SEPARATOR"],postprocess:B},{name:"Expression",symbols:["AssignmentExpression"],postprocess:B},{name:"AssignmentExpression",symbols:["Identifier","_","EQUALS","_","Ternary"],postprocess:ie=>De(ie,"=")},{name:"AssignmentExpression",symbols:["Identifier","_","PLSEQUALS","_","Ternary"],postprocess:ie=>De(ie,"+=")},{name:"AssignmentExpression",symbols:["Identifier","_","MINEQUALS","_","Ternary"],postprocess:ie=>De(ie,"-=")},{name:"AssignmentExpression",symbols:["Ternary"],postprocess:B},{name:"Ternary",symbols:["Ternary","_","QUESTION","_","TernaryPair"],postprocess:z},{name:"Ternary",symbols:["Binary"],postprocess:B},{name:"TernaryPair",symbols:["Expression","_","COLON","_","Expression"],postprocess:b(e.Pair)},{name:"Binary",symbols:["Logical"],postprocess:B},{name:"Logical",symbols:["Logical","_",{literal:"||"},"_","Bitwise"],postprocess:g},{name:"Logical",symbols:["Logical","_",{literal:"&&"},"_","Bitwise"],postprocess:g},{name:"Logical",symbols:["Bitwise"],postprocess:B},{name:"Bitwise",symbols:["Bitwise","_",{literal:"|"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Bitwise","_",{literal:"^"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Bitwise","_",{literal:"&"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Equality"],postprocess:B},{name:"Equality",symbols:["Equality","_",{literal:"=="},"_","Comparison"],postprocess:g},{name:"Equality",symbols:["Equality","_",{literal:"!="},"_","Comparison"],postprocess:g},{name:"Equality",symbols:["Comparison"],postprocess:B},{name:"Comparison",symbols:["Comparison","_",{literal:"<"},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:">"},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:"<="},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:">="},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Shift"],postprocess:B},{name:"Shift",symbols:["Shift","_",{literal:">>"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Shift","_",{literal:"<<"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Shift","_",{literal:">>>"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Sum"],postprocess:B},{name:"Sum",symbols:["Sum","_",{literal:"+"},"_","Product"],postprocess:g},{name:"Sum",symbols:["Sum","_",{literal:"-"},"_","Product"],postprocess:g},{name:"Sum",symbols:["Product"],postprocess:B},{name:"Product",symbols:["Product","_",{literal:"*"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Product","_",{literal:"/"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Product","_",{literal:"%"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Typecast"],postprocess:B},{name:"Typecast",symbols:["Expression","_","COLON","_","DeclType"],postprocess:b(e.Pair)},{name:"Typecast",symbols:["Expression","_","AS","_","DeclType"],postprocess:b(e.Pair)},{name:"Typecast",symbols:["Unary"],postprocess:B},{name:"Unary",symbols:[{literal:"!"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"~"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"-"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"+"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"++"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"--"},"Call"],postprocess:M},{name:"Unary",symbols:["Call"],postprocess:B},{name:"Call",symbols:["Subscript","_","LB","_","ArgumentList","_","RB"],postprocess:v(C,p)},{name:"Call",symbols:["Subscript","_","LB","_","RB"],postprocess:C},{name:"Call",symbols:["Subscript"],postprocess:B},{name:"ArgumentList",symbols:["Expression"],postprocess:B},{name:"ArgumentList",symbols:["NativeType"],postprocess:B},{name:"ArgumentList",symbols:["Expression","_","COMMA","_","ArgumentList"],postprocess:p},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB","Subscript"],postprocess:X},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB"],postprocess:X},{name:"Subscript",symbols:["Access"],postprocess:B},{name:"Access",symbols:["Access","DOT","Identifier"],postprocess:v(Q,i)},{name:"Access",symbols:["NativeType","DOT","Access"],postprocess:v(Q,i)},{name:"Access",symbols:["Grouping"],postprocess:B},{name:"Grouping",symbols:["LB","_","Expression","_","RB"],postprocess:c(2)},{name:"Grouping",symbols:["Atom"],postprocess:B},{name:"Atom",symbols:["Identifier"],postprocess:B},{name:"Atom",symbols:["StringLiteral"],postprocess:B},{name:"Atom",symbols:["CharacterLiteral"],postprocess:B},{name:"Atom",symbols:["Number"],postprocess:B},{name:"NativeType",symbols:[s.has("type")?{type:"type"}:Z],postprocess:Z},{name:"Identifier",symbols:[s.has("identifier")?{type:"identifier"}:L],postprocess:L},{name:"Number",symbols:[s.has("number")?{type:"number"}:number],postprocess:A},{name:"StringLiteral",symbols:[s.has("string")?{type:"string"}:Y],postprocess:Y},{name:"CharacterLiteral",symbols:[s.has("char")?{type:"char"}:q],postprocess:q},{name:"word",symbols:[/[a-zA-Z_]/],postprocess:B},{name:"word",symbols:["word",/[a-zA-Z0-9_]/],postprocess:h},{name:"digit",symbols:[/[0-9]/],postprocess:B},{name:"digit",symbols:["digit",/[0-9]/],postprocess:h},{name:"SEPARATOR",symbols:["_",{literal:";"}],postprocess:l},{name:"QUESTION",symbols:[{literal:"?"}],postprocess:l},{name:"COMMA",symbols:[{literal:","}],postprocess:l},{name:"AND",symbols:[{literal:"&"}],postprocess:l},{name:"DOT",symbols:[{literal:"."}],postprocess:l},{name:"LB",symbols:[{literal:"("}],postprocess:l},{name:"RB",symbols:[{literal:")"}],postprocess:l},{name:"LSB",symbols:[{literal:"["}],postprocess:l},{name:"RSB",symbols:[{literal:"]"}],postprocess:l},{name:"LCB",symbols:[{literal:"{"}],postprocess:l},{name:"RCB",symbols:[{literal:"}"}],postprocess:l},{name:"OR",symbols:[{literal:"|"}],postprocess:l},{name:"COLON",symbols:[{literal:":"}],postprocess:l},{name:"EQUALS",symbols:[{literal:"="}],postprocess:l},{name:"PLSEQUALS",symbols:[{literal:"+="}],postprocess:l},{name:"MINEQUALS",symbols:[{literal:"-="}],postprocess:l},{name:"GT",symbols:[{literal:">"}],postprocess:l},{name:"LT",symbols:[{literal:"<"}],postprocess:l},{name:"FATARROW",symbols:[{literal:"=>"}],postprocess:l},{name:"SPREAD",symbols:[{literal:"..."}],postprocess:l},{name:"FUNCTION",symbols:[{literal:"function"}],postprocess:l},{name:"LET",symbols:[{literal:"let"}],postprocess:l},{name:"CONST",symbols:[{literal:"const"}],postprocess:l},{name:"EXPORT",symbols:[{literal:"export"}],postprocess:l},{name:"IMPORT",symbols:[{literal:"import"}],postprocess:l},{name:"AS",symbols:[{literal:"as"}],postprocess:l},{name:"FROM",symbols:[{literal:"from"}],postprocess:l},{name:"RETURN",symbols:[{literal:"return"}],postprocess:l},{name:"TYPE",symbols:[{literal:"type"}],postprocess:l},{name:"IF",symbols:[{literal:"if"}],postprocess:l},{name:"ELSE",symbols:[{literal:"else"}],postprocess:l},{name:"FOR",symbols:[{literal:"for"}],postprocess:l},{name:"WHILE",symbols:[{literal:"while"}],postprocess:l},{name:"SWITCH",symbols:[{literal:"switch"}],postprocess:l},{name:"DO",symbols:[{literal:"do"}],postprocess:l},{name:"THROW",symbols:[{literal:"throw"}],postprocess:l},{name:"BREAK",symbols:[{literal:"break"}],postprocess:l}],ParserStart:"Program"}}function Qn(s){return s[0]}function Hn(){let s=this.Syntax,{flatten:e}=this.helpers,{node:r}=this.nodes(this.lexer);return{Lexer:void 0,ParserRules:[{name:"TypeList",symbols:["DefaultArgument"],postprocess:Qn},{name:"TypeList",symbols:["DefaultArgument","_","COMMA","_","TypeList"],postprocess:e},{name:"DefaultArgument",symbols:["Type","_","EQUALS","_","Atom"],postprocess:r(s.Assignment)},{name:"ParameterList",symbols:["DefaultFunctionArgument"],postprocess:Qn},{name:"ParameterList",symbols:["DefaultFunctionArgument","_","COMMA","_","ParameterList"],postprocess:e},{name:"DefaultFunctionArgument",symbols:["NameAndType","_","EQUALS","_","Atom"],postprocess:r(s.Assignment)}],ParserStart:"TypeList"}}var Kn=re(function(s){(function(e,r){s.exports?s.exports=r():e.nearley=r()})(ve,function(){function e(h,p,v){return this.id=++e.highestId,this.name=h,this.symbols=p,this.postprocess=v,this}e.highestId=0,e.prototype.toString=function(h){function p(b){return b.literal?JSON.stringify(b.literal):b.type?"%"+b.type:b.toString()}var v=typeof h>"u"?this.symbols.map(p).join(" "):this.symbols.slice(0,h).map(p).join(" ")+" \u25CF "+this.symbols.slice(h).map(p).join(" ");return this.name+" \u2192 "+v};function r(h,p,v,b){this.rule=h,this.dot=p,this.reference=v,this.data=[],this.wantedBy=b,this.isComplete=this.dot===h.symbols.length}r.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},r.prototype.nextState=function(h){var p=new r(this.rule,this.dot+1,this.reference,this.wantedBy);return p.left=this,p.right=h,p.isComplete&&(p.data=p.build()),p},r.prototype.build=function(){var h=[],p=this;do h.push(p.right.data),p=p.left;while(p.left);return h.reverse(),h},r.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,m.fail))};function i(h,p){this.grammar=h,this.index=p,this.states=[],this.wants={},this.scannable=[],this.completed={}}i.prototype.process=function(h){for(var p=this.states,v=this.wants,b=this.completed,g=0;g<p.length;g++){var A=p[g];if(A.isComplete){if(A.finish(),A.data!==m.fail){for(var L=A.wantedBy,R=L.length;R--;){var M=L[R];this.complete(M,A)}if(A.reference===this.index){var z=A.rule.name;(this.completed[z]=this.completed[z]||[]).push(A)}}}else{var z=A.rule.symbols[A.dot];if(typeof z!="string"){this.scannable.push(A);continue}if(v[z]){if(v[z].push(A),b.hasOwnProperty(z))for(var X=b[z],R=0;R<X.length;R++){var Q=X[R];this.complete(A,Q)}}else v[z]=[A],this.predict(z)}}},i.prototype.predict=function(h){for(var p=this.grammar.byName[h]||[],v=0;v<p.length;v++){var b=p[v],g=this.wants[h],A=new r(b,0,this.index,g);this.states.push(A)}},i.prototype.complete=function(h,p){var v=h.nextState(p);this.states.push(v)};function c(h,p){this.rules=h,this.start=p||this.rules[0].name;var v=this.byName={};this.rules.forEach(function(b){v.hasOwnProperty(b.name)||(v[b.name]=[]),v[b.name].push(b)})}c.fromCompiled=function(b,p){var v=b.Lexer;b.ParserStart&&(p=b.ParserStart,b=b.ParserRules);var b=b.map(function(A){return new e(A.name,A.symbols,A.postprocess)}),g=new c(b,p);return g.lexer=v,g};function l(){this.reset("")}l.prototype.reset=function(h,p){this.buffer=h,this.index=0,this.line=p?p.line:1,this.lastLineBreak=p?-p.col:0},l.prototype.next=function(){if(this.index<this.buffer.length){var h=this.buffer[this.index++];return h===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:h}}},l.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},l.prototype.formatError=function(h,p){var v=this.buffer;if(typeof v=="string"){var b=v.indexOf(`
`,this.index);b===-1&&(b=v.length);var g=v.substring(this.lastLineBreak,b),A=this.index-this.lastLineBreak;return p+=" at line "+this.line+" col "+A+`:

`,p+="  "+g+`
`,p+="  "+Array(A).join(" ")+"^",p}else return p+" at index "+(this.index-1)};function m(h,p,v){if(h instanceof c)var b=h,v=p;else var b=c.fromCompiled(h,p);this.grammar=b,this.options={keepHistory:!1,lexer:b.lexer||new l};for(var g in v||{})this.options[g]=v[g];this.lexer=this.options.lexer,this.lexerState=void 0;var A=new i(b,0);this.table=[A],A.wants[b.start]=[],A.predict(b.start),A.process(),this.current=0}return m.fail={},m.prototype.feed=function(h){var p=this.lexer;p.reset(h,this.lexerState);for(var v;v=p.next();){var b=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var g=this.current+1,A=new i(this.grammar,g);this.table.push(A);for(var L=v.text!==void 0?v.text:v.value,R=p.constructor===l?v.value:v,M=b.scannable,z=M.length;z--;){var X=M[z],Q=X.rule.symbols[X.dot];if(Q.test?Q.test(R):Q.type?Q.type===v.type:Q.literal===L){var $e=X.nextState({data:R,token:v,isToken:!0,reference:g-1});A.states.push($e)}}if(A.process(),A.states.length===0){var pe=this.lexer.formatError(v,"invalid syntax")+`
`;pe+="Unexpected "+(v.type?v.type+" token: ":""),pe+=JSON.stringify(v.value!==void 0?v.value:v)+`
`;var C=new Error(pe);throw C.offset=this.current,C.token=v,C}this.options.keepHistory&&(b.lexerState=p.save()),this.current++}return b&&(this.lexerState=p.save()),this.results=this.finish(),this},m.prototype.save=function(){var h=this.table[this.current];return h.lexerState=this.lexerState,h},m.prototype.restore=function(h){var p=h.index;this.current=p,this.table[p]=h,this.table.splice(p+1),this.lexerState=h.lexerState,this.results=this.finish()},m.prototype.rewind=function(h){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[h])},m.prototype.finish=function(){var h=[],p=this.grammar.start,v=this.table[this.table.length-1];return v.states.forEach(function(b){b.rule.name===p&&b.dot===b.rule.symbols.length&&b.reference===0&&b.data!==m.fail&&h.push(b)}),h.map(function(b){return b.data})},{Parser:m,Grammar:c,Rule:e}})}),Is=Kn.Parser,Ns=Kn.Grammar,Rs=(...s)=>s.reduce((e,r)=>(...i)=>e(r(...i))),P=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Bs=function(s,e){var r={};for(var i in s)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i]);return r};let W=At((s,e)=>{let{meta:r}=s,i=Bs(s,["meta"]);return P({},e,{meta:P({},e.meta,r)},i)}),ks=s=>e=>e[s],Fs=()=>null,Ve=s=>Array.isArray(s)?!!s.length:s!=null,Ms=s=>`${s[0]}${s[1]}`,js=s=>s.reduce((e,r)=>(Array.isArray(r),e.concat(r)),[]),de=s=>s.filter(Ve);var Us={nth:ks,nuller:Fs,nonEmpty:Ve,add:Ms,flatten:js,compose:Rs,drop:de,extendNode:W};let Ds=s=>{let{col:e,line:r}=s;return s.lines.length?{col:e,line:r,sourceLine:s.lines[s.line-1]}:{col:e,line:r,sourceLine:""}};function zs(s){let e=(c,l={})=>m=>{let h=m.filter(Ve),{value:p="",meta:v={}}=l,b=Ds(s),g=h[h.length-1]&&h[h.length-1].range?h[h.length-1].range[1]:P({},b,{col:b.col+p.length});return{value:p,type:null,Type:c,toString(){},meta:v,range:[b,g],params:h}},r=c=>{let[l,m,h]=c.filter(Ve),p=d.BinaryExpression;return(m.value==="||"||m.value==="&&")&&(p=d.Select),e(p,{value:m.value})([l,h])},i=c=>{let[l]=de(c);return W({type:l!=null&&l.value!=="void"?l.value:null},e(d.FunctionResult)(c))};return{node:e,binary:r,constant:c=>{let l=c[0].value;return W({value:`${l}`,type:l.toString().indexOf(".")!==-1?"f32":"i32"},e(d.Constant)([]))},identifier:c=>e("Identifier",{value:c.join("")})([]),unary:([c,l])=>{let m=[l];return c.value==="-"&&(m=[P({},l,{value:"0",Type:d.Constant,params:[],meta:{}}),l]),W({value:c.value,params:m},e(d.UnaryExpression)([c,l]))},ternary:c=>W({value:"?"},e(d.TernaryExpression)(c)),subscript:c=>{let[l,m]=c.filter(Ve);return W({value:l.value,params:[l,m]},e(d.ArraySubscript)([l,m]))},access(c){return W({value:c[0].value+"."+c[1].value},e(d.Access)(c))},fun:c=>{let[l,m,h,p]=c.filter(Ve);return P({},l,{Type:d.FunctionDeclaration,meta:[],params:[m,h,p]})},declaration:c=>l=>{let[m,...h]=de(l),[p,v]=m.params;return W({value:p.value,type:v.value},e(c)(h))},call:c=>{let[l,...m]=de(c);return W({value:l.value},e(d.FunctionCall)([l,...m]))},struct:c=>{let[l,...m]=de(c);return W({value:l.value},e(d.Struct)(m))},result:i,string:c=>W({value:c[0].value,type:"i32"},e(d.StringLiteral)([])),char(c){return W({value:c[0].value,type:"i32"},e(d.CharacterLiteral)([]))},type(c){return W({value:c[0].value,type:c[0].value,params:[]},e(d.Type)(c))},arrayType(c){let m=de(c)[0];return W({value:m.value+"[]",type:m.type+"[]",params:[]},e(d.ArrayType)(c))},typeGeneric(c){let[l,m]=de(c);return W({value:l.value,type:l.value,params:[m]},e(d.Type)(c))},typedef:c=>{let[l,m,h]=de(c);return W({value:l.value,params:[e(d.FunctionArguments)(m),W({type:h.value},e(d.FunctionResult)([h]))],type:h.type},e(d.Typedef)([l,m,i]))},voidFun:c=>{let l=de(c),[m,h,p]=l,v=W({type:null},e(d.FunctionResult)([]));return W({value:m.value,params:[h,v,p]},e(d.FunctionDeclaration)(l))},assignment(c,l){if(["-=","+="].includes(l)){let m=l[0],[h,p]=de(c),v=r([h,{value:m},p]);return e(d.Assignment,{value:"="})([h,v])}return e(d.Assignment,{value:l})(c)},assignmentExpr(c,l){if(["-=","+="].includes(l)){let m=l[0],[h,p]=de(c),v=r([h,{value:m},p]);return e(d.AssignmentExpression,{value:"="})([h,v])}return e(d.AssignmentExpression,{value:l})(c)},forLoop(c){let[l,m,h,...p]=de(c);return e(d.Loop)([l,m,...p,h])},whileLoop(c){let l=e(d.Noop)([]);return e(d.Loop)([l,...c])},spread(c){return e(d.Spread)(c)},builtinDecl(c){let[l,m]=de(c);return W({value:l.value,type:m.value,params:[m]},e(d.ImmutableDeclaration)(c))},addressOf(c){let[l]=de(c);return W({value:l.value,params:[]},e("AddressOf")(c))}}}function Gs(){let s=As.compile(be);return{current:null,lines:[],get line(){return s.line},get col(){return s.col},save(){return s.save()},reset(e,r){return this.lines=e.split(`
`),s.reset(e,r)},next(){let e=s.next();for(;e&&e.type==="comment";)e=s.next();return this.current=e,this.current},formatError(e){return s.formatError(e)},has(e){return s.has(e)}}}var Zt=At(function(s,e){let r=[Ps,Hn,...s],i={lexer:Gs(),nodes:zs,helpers:Us,Syntax:d},c=r.slice(1).reduce((m,h)=>{let p=h.call(i);return P({},m,{ParserRules:m.ParserRules.concat(p.ParserRules)})},r[0].call(i)),l=new Is(Ns.fromCompiled(c));return l.feed(e),I(l.results.length===1,`PANIC - Ambiguous Syntax! Number of productions (${l.results.length})`),l.results[0]});let Ys=s=>{let e,r=s.reduce((i,c)=>c(l=>i(l,e)),([i])=>i);return(i,c)=>(e=c,r(i,e))},qs=s=>{let e=[],r=s.reduce((i,c)=>(Object.entries(c).forEach(([l,m])=>{if(l==="*"){e.push(m);return}i[l]==null&&(i[l]=[...e]),i[l].push(m)}),i),{});return Object.entries(r).reduce((i,[c,l])=>(i[c]=Ys(l),i),{})},Xn=Symbol("scope namespace"),Zn=Symbol("signature");function Vs(s,e){return[...s,{[Xn]:e,[Zn]:{result:null,arguments:null}}]}function Js(s){return s.slice(0,-1)}function er(s){return s[s.length-1]}function Ws(s,e,r){let i=er(s);return i&&(i[e]=r),i}function Qs(s,e){let i=s.length-1;for(i;i>=0;i--){let c=s[i][e];if(c)return c}return null}function Hs(s,e){let r=Object.keys(s).indexOf(e);return r>-1?r:Object.keys(s).length}var Ks={enter:Vs,exit:Js,add:Ws,find:Qs,current:er,index:Hs,namespace:Xn,signature:Zn};let{enter:Xs,exit:Zs,add:eo,find:to,current:no,namespace:ro,signature:so,index:oo}=Ks;var Be={enter:Xs,exit:Zs,add:eo,find:to,current:no,namespace:ro,index:oo,signature:so},tr=Be.enter,ao=Be.exit,je=Be.current,Je=Be.find,io=Be.add,nr=Be.index,rr=Be.namespace,We=Be.signature;let Oe="function/index",wt="LOCAL_INDEX",Le="global/index",$t="type/const",ft="TYPE_INDEX",co="OBJECT_SIZE",en="type/cast",tn="AST_METADATA",nn="FUNCTION_METADATA",ke=s=>{switch(s){case"i32":case"bool":return 0;case"i64":return 1;case"f32":return 2;case"f64":return 3;default:return-1}},rn=s=>{let e=s.params.reduce((i,{type:c})=>ke(i)<ke(c)?c:i,s.type),r=s.params.map(i=>i.type!=null&&ke(i.type)!==ke(e)?i.Type===d.Constant?W({type:e},i):W({type:e,value:i.value,Type:d.TypeCast,meta:{[en]:{to:e,from:i.type}},params:[i]},i):i);return P({},s,{params:r,type:e})};function lo(){return{semantics(){let s=e=>([r,i])=>{let c=je(i.scopes),l=nr(c,r.value);return c[r.value]=W({params:r.params.map(W({type:r.type})),meta:P({},r.meta,{[c[rr]]:l,[$t]:r.Type===d.ImmutableDeclaration}),Type:d.Declaration},r),e([c[r.value],i])};return{[d.Export]:e=>([r,i])=>{let c=e([r,i]),[l]=c.params;return i.exports[l.value]=l,c},[d.Declaration]:s,[d.ImmutableDeclaration]:s,[d.Select]:e=>([r,i],c)=>rn(P({},r,{params:r.params.map(l=>c([l,i]))})),[d.BinaryExpression]:e=>([r,i],c)=>rn(P({},r,{params:r.params.map(l=>c([l,i]))})),[d.Pair]:e=>(r,i)=>{let[c,l]=r,m=c.params.map(g=>i([g,l])),[h,p]=m,{type:v}=h,{value:b}=p;return P({},c,{type:b,value:h.value,Type:d.TypeCast,meta:P({},c.meta,{[en]:{to:b,from:v}}),params:[h]})},[d.Identifier]:e=>r=>{let[i,c]=r,l=Je(c.scopes,i.value);return l?P({},i,{meta:P({},i.meta,l.meta),type:l.type}):i.value==="null"?P({},i,{value:"0",type:"i32",Type:d.Constant}):e(r)},[d.TernaryExpression]:e=>([r,i])=>e([rn(P({},r,{params:[...r.params[1].params,r.params[0]]})),i])}}}}function uo(){return{semantics(){return{"*":s=>function([e,...r],i){return P({},e,{params:e.params.map(l=>i([l,...r]))})}}}}}function po(){return{semantics(){return{[d.Typedef]:s=>([e])=>e,[d.Program]:s=>e=>{let[r,i]=e,{types:c}=i,l=N({[d.Export]:(m,h)=>{let[p]=m.params;return p!=null&&[d.Typedef,d.Struct].includes(p.Type)?h(P({},p,{meta:P({},p.meta,{EXPORTED:!0})})):m},[d.Typedef]:(m,h)=>{let p=0,[v]=m.params,b=[];D({Assignment(A){let L=A.params[1];b.push(L)},Type(){p+=1}})(v);let g=P({},m,{meta:P({},m.meta,{FUNCTION_METADATA:{argumentsCount:p},DEFAULT_ARGUMENTS:b})});return c[m.value]=g,g}})(r);return s([l,i])}}}}}let fo={i64:63,f64:63,i32:31,f32:31},mo={i64:"0xffffffffffff",f64:"0xffffffffffff",i32:"0xffffff",f32:"0xffffff"};function ho(){return{semantics({stmt:s}){return{[d.UnaryExpression]:e=>(r,i)=>{let[c,l]=r,[m,h]=c.params.map(p=>i([p,l]));switch(c.value){case"!":let p=fo[m.type];return i([s`(((${m} >> ${p}) | ((~${m} + 1) >> ${p})) + 1);`,l]);case"~":let v=mo[i([m,l]).type];return i([s`(${m} ^ ${v});`,l]);case"-":if(h.Type===d.Constant)return P({},h,{meta:P({},h.meta,{SIGN:-1})});default:return i([P({},c,{type:h.type,params:[P({},m,{type:h.type}),h],Type:d.BinaryExpression}),l])}}}}}}function yo(){return{semantics(){return{[d.FunctionDeclaration]:s=>([e,r],i)=>{r.scopes=tr(r.scopes,wt);let c=je(r.scopes),[l,m,h]=e.params,[p,v]=[l,m].map(g=>i([g,r])),b=P({},e,{type:c[We].result,meta:P({},e.meta,{[Oe]:Object.keys(r.functions).length,[nn]:{argumentsCount:c[We].arguments.length,locals:je(r.scopes)}})});return r.functions[e.value]=b,b.params=[p,v,i([h,r])],r.scopes=ao(r.scopes),b},[d.FunctionResult]:s=>([e,r])=>{let i=je(r.scopes);return i[We].result=e.type,e},[d.FunctionArguments]:s=>([e,r],i)=>{let c=je(r.scopes);return c[We].arguments=[],N({[d.Pair]:(m,h)=>{let[p,v]=m.params,b=i([v,r]);return c[We].arguments.push(m),i([P({},m,{value:p.value,type:b.value,params:[],Type:d.Declaration}),r]),P({},m,{params:[p,b]})}})(P({},e,{params:e.params.filter(Boolean)}))},[d.FunctionCall]:s=>([e,r])=>{let{functions:i}=r,c=Object.keys(i).indexOf(e.value);return s([P({},e,{type:i[e.value]!=null?i[e.value].type:null,meta:{[Oe]:c},params:e.params.slice(1)}),r])},[d.ReturnStatement]:s=>([e,r],i)=>{let c=je(r.scopes),[l]=e.params.map(p=>i([p,r])),{result:m}=c[We];if(l!=null&&l.Type===d.Constant&&ke(l.type)!==ke(m))return P({},e,{type:m,params:[P({},l,{type:m})]});let h=l?l.type:null;return P({},e,{params:[l],type:h})}}}}}function bo(){return{semantics:()=>({[d.Import]:s=>e=>{let[r,i]=e;return N({[d.BinaryExpression]:(c,l)=>{let[m,h]=c.params;if(m.Type!==d.Pair)return c;let[p,v]=m.params;return l(P({},m,{params:[P({},h,{meta:P({},p.meta,{AS:p.value})}),v]}))},[d.Pair]:(c,l)=>{let{types:m,functions:h}=i,[p,v]=c.params;if(m[v.value]!=null){let b=Object.keys(h).length,g=Object.keys(m).indexOf(v.value),A=P({},p,{id:p.value,type:m[v.value].type,meta:P({},p.meta,{[Oe]:b,[ft]:g,FUNCTION_METADATA:m[v.value].meta.FUNCTION_METADATA,DEFAULT_ARGUMENTS:m[v.value].meta.DEFAULT_ARGUMENTS})});return h[p.value]=A,P({},c,{params:[A,m[v.value]]})}if(["Table","Memory"].includes(v.value)){let b=v.value==="Memory"?"memories":"tables";i[b].push(p)}else{let b=je(i.scopes),g=nr(b,p.value);io(i.scopes,p.value,P({},p,{meta:{[b[rr]]:g,[$t]:!0},type:v.type}))}return c}})(r)}})}}function _o(){return{semantics(){let s=e=>([r,i])=>r.type==="bool"?e([P({},r,{type:"i32"}),i]):e([r,i]);return{[d.Identifier]:e=>(r,i)=>{let[c,l]=r;return c.value==="true"||c.value==="false"?i([P({},c,{Type:d.Constant,value:c.value==="true"?"1":"0",type:"i32"}),l]):e(r)},[d.FunctionResult]:e=>([r,i])=>r.type==="bool"?e([P({},r,{type:"i32"}),i]):e([r,i]),[d.Declaration]:s,[d.ImmutableDeclaration]:s}}}}function sr(s,e){let r=[null,e];return function(i){return r[0]=i,s(r)}}function go(s,e){let r={},i=0;for(i;i<s.length;i++)r[s[i]]=e[s[i]];return r}let vo={i32:2,f32:2,i64:3,f64:3},So="i32";function To({stmt:s}){let e=l=>m=>{let[h,p]=m;if(!String(h.type).endsWith("[]"))return l(m);let v=W({type:So,meta:{TYPE_ARRAY:h.type.slice(0,-2)}},h);return l([v,p])};function r(l,m){let h=vo[l.meta.TYPE_ARRAY]||2;return m.Type!==d.Constant||Number(m.value)?s`(${l} + (${m} << ${h}));`:s`(${l});`}function i(l){return!(l.type==null||l.index==null)}function c([l,m]){let h=l.meta.TYPE_ARRAY,p=r(l,m);return{type:h,index:p,TYPE_ARRAY:l.meta.TYPE_ARRAY}}return{[d.Declaration]:e,[d.ImmutableDeclaration]:e,[d.Identifier]:l=>m=>{let[h,p]=m,v=Je(p.scopes,h.value);return v&&v.meta.TYPE_ARRAY?l([W(go(["type","meta"],v),h),p]):l(m)},[d.Assignment]:l=>(m,h)=>{let[p,v]=m,[b,g]=p.params;if(b.Type!==d.ArraySubscript)return l(m);let A=sr(h,v),L=c(b.params.map(A)),{type:R,index:M}=L;return I(i(L),`PANIC - Cannot assign to subscript of ${b.value}`),A(s`${R}.store(${M}, ${g});`)},[d.ArraySubscript]:l=>(m,h)=>{let[p,v]=m,b=sr(h,v),g=c(p.params.map(b)),{type:A,index:L,TYPE_ARRAY:R}=g;return i(g)?W({meta:{TYPE_ARRAY:R}},b(s`${A}.load(${L});`)):l(m)},[d.FunctionResult]:e}}function Eo(){return{semantics:To}}let xo=(s,e)=>{let r=s.memories[0];return r&&r.value===e.value};function Ao(){return{semantics({stmt:s}){return{[d.ImmutableDeclaration]:e=>r=>{let[i,c]=r,{scopes:l,memories:m}=c;return!l.length<2&&i.type==="Memory"&&!m.length?(m.push(P({},i,{meta:P({},i.meta,{[Le]:-1})})),m[0]):e(r)},[d.FunctionCall]:e=>(r,i)=>{let[c,l]=r,[m,...h]=c.params,[p={},v={}]=m.params,g={dataSize:i([s`i32.load(0);`,l]),grow:P({},p,{value:"grow_memory",params:h.map(A=>i([A,l])),Type:d.NativeMethod}),size:P({},p,{value:"current_memory",params:[],Type:d.NativeMethod})}[v.value];return m.Type===d.Access&&xo(l,p)&&g?g:e(r)}}}}}let or=s=>{let e=[];for(;;){let r=s&127;s=s>>7;let i=r&64;if(s===0&&!i||s===-1&&i){e.push(r);break}else e.push(r|128)}return e},wo=s=>{let e=[];for(;;){let r=s&127;if(s=s>>>7,s===0){e.push(r);break}e.push(r|128)}return e};let Ct=1,Ot=1<<1,Lt=1<<2,Pt=1<<3,It=1<<4,Nt=1<<5,ar=1<<6,Rt=1<<7,Bt=1<<8,kt=1<<9,Ft=1<<10,Mt=1<<11,sn=1<<12,Se=4,$o={[Ct]:Se,[Ot]:Se*2,[Lt]:Se,[Pt]:Se*2,[Mt]:Se,[Ft]:Se>>1,[Bt]:Se>>2,[Rt]:Se>>2,[kt]:Se>>1,[It]:Se,[Nt]:Se,[ar]:Se},se=!0;var Pe={i32:Ct,i64:Ot,f32:Lt,f64:Pt,anyfunc:It,func:Nt,block_type:ar,i8:Rt,u8:Bt,i16:kt,u16:Ft,u32:Mt,u64:sn,set:(s,e,r,i)=>{switch(s){case Ct:return r.setInt32(e,i,se);case Ot:return r.setInt64(e,i,se);case Lt:return r.setFloat32(e,i,se);case Pt:return r.setFloat64(e,i,se);case It:return r.setUint32(e,i,se);case Nt:return r.setUint32(e,i,se);case Rt:return r.setInt8(e,i,se);case Bt:return r.setUint8(e,i,se);case kt:return r.setInt16(e,i,se);case Ft:return r.setUint16(e,i,se);case Mt:return r.setUint32(e,i,se);case sn:return r.setUint64(e,i,se);default:return r.setUint8(e,i,se)}},get:(s,e,r)=>{switch(s){case Ct:return r.getInt32(e,se);case Ot:return r.getInt64(e,se);case Lt:return r.getFloat32(e,se);case Pt:return r.getFloat64(e,se);case It:return r.getUint32(e,se);case Nt:return r.getUint32(e,se);case Rt:return r.getInt8(e,se);case Bt:return r.getUint8(e,se);case kt:return r.getInt16(e,se);case Ft:return r.getUint16(e,se);case Mt:return r.getUint32(e,se);case sn:return r.getUint64(e,se);default:return r.getUint8(e,se)}},sizeof:$o},T=Pe.i32,O=Pe.i64,$=Pe.f32,oe=Pe.f64,ce=Pe.u8,on=Pe.u32,ir=Pe.set,an=Pe.sizeof;class le{constructor(){this.data=[],this.size=0}push(e,r,i){let c=0;switch(e){case"varuint7":case"varuint32":case"varint7":case"varint1":{r=wo(r),c=r.length,I(c,`Cannot write a value of size ${c}`);break}case"varint32":{r=or(r),c=r.length,I(c,`Cannot write a value of size ${c}`);break}case"varint64":{r=or(r),c=r.length,I(c,`Cannot write a value of size ${c}`);break}default:c=an[e],I(c,`Cannot write a value of size ${c}, type ${e}`)}return this.data.push({type:e,value:r,debug:i}),this.size+=c,this}buffer(e=new ArrayBuffer(this.size)){let r=new DataView(e),i=0;return this.data.forEach(({type:c,value:l})=>{Array.isArray(l)?l.forEach(m=>ir(ce,i++,r,m)):(ir(c,i,r,l),i+=an[c])}),e}write(e){return e&&(this.data=this.data.concat(e.data),this.size+=e.size),this}}function*Co(s,e){let r=0,i=0,c=0,l=e;for(;;){let h=s.getUint8(l,!0);if(r|=(h&127)<<c,l+=1,!(h&128))break;c+=7}let m=0;for(;i<r;){for(m=0,c=0;;){let h=s.getUint8(l,!0);if(m|=(h&127)<<c,l+=1,!(h&128))break;c+=7}i+=1,yield m}}function cr(s){let e=new le,r=new le;r.push("varuint32",s.length,s);let i=0;for(i=0;i<s.length;i++)r.push("varuint32",s.codePointAt(i),s[i]);return e.write(r),e}let Oo={["\\0"]:0,["\\a"]:7,["\\b"]:8,["\\t"]:9,["\\n"]:10,["\\v"]:11,["\\f"]:12,["\\r"]:13,["\\'"]:39},Lo={i64:8,f64:8,i32:4,f32:4};function Po(s,e){let r=new le,i=Pe[e];return s.forEach(c=>{r.push(i,c,String(c))}),r}function Io(){let s=0;return{semantics:({stmt:e})=>({[d.StaticDeclaration]:r=>([i,c],l)=>{let{userTypes:m,statics:h}=c,p=String(i.type).slice(0,-2),v=Lo[p],b=i.params.reduce((A,L,R)=>{let M=l([L,c]);return A.OBJECT_SIZE+=v,A.TYPE_OBJECT[R]=R*v,A.OBJECT_KEY_TYPES[R]=p,A.VALUES.push(Number(M.value)),A},{OBJECT_SIZE:0,TYPE_OBJECT:{},OBJECT_KEY_TYPES:{},VALUES:[],STATIC:p}),g=`__auto_gen_${i.value}_${s}`;return s+=1,m[g]=P({},i,{value:g,Type:d.Type,meta:b,params:[]}),h[g]=Po(b.VALUES,p),l([P({},i,{meta:b,type:g,Type:d.ImmutableDeclaration,params:[P({},i.params[0],{value:g,Type:d.StaticValueList})]}),c])},[d.ArraySubscript]:r=>([i,c],l)=>{let[m,h]=i.params.map(v=>l([v,c]));if(!m.meta.STATIC)return r([i,c]);let p={i32:2,f32:2,i64:3,f64:3}[m.meta.STATIC];return l([e`${m.meta.STATIC}.load(${m} + (${h} << ${p}));`,c])},[d.CharacterLiteral]:r=>([i,c],l)=>{let m=Oo[i.value]||i.value.codePointAt(0);return l([P({},i,{Type:"Constant",type:"i32",value:String(m)}),c])},[d.StringLiteral]:r=>i=>{let[c,l]=i,{statics:m}=l,{value:h}=c;return h in m||(m[h]=cr(h)),c}})}}function No(){return{semantics(){return{[d.ImmutableDeclaration]:s=>function(e){let[r,i]=e;return!i.locals&&r.type==="Table"?P({},r,{meta:P({},r.meta,{[Le]:-1})}):s(e)},[d.Identifier]:s=>function(e){let[r,i]=e,{functions:c,table:l,scopes:m}=i;return Je(m,r.value)||!c[r.value]?s(e):(l[r.value]==null&&(l[r.value]=c[r.value]),P({},r,{type:"i32",meta:{[Oe]:c[r.value].meta[Oe]},value:Object.keys(l).indexOf(r.value),Type:d.FunctionPointer}))},[d.FunctionResult]:s=>(e,r)=>{let[i,c]=e,{types:l}=c;return l[i.type]?s([W({type:"i32",meta:{ALIAS:i.type},params:i.params.map(m=>r([m,c]))},i),c]):s(e)},[d.FunctionCall]:s=>function(e,r){let[i,c]=e,{scopes:l,types:m}=c,h=Je(l,i.value);if(!h)return s(e);let p=m[h.type],v=Object.keys(m).indexOf(h.type),b=[...i.params.slice(1),P({},h,{Type:d.Identifier})].map(g=>r([g,c]));return P({},i,{meta:P({},i.meta,h.meta,{[ft]:v}),type:p!=null?p.type:i.type,params:b,Type:d.IndirectFunctionCall})}}}}}let jt="i32",Ro={i64:8,f64:8,i32:4,f32:4,["__DIRECT_ADDRESS__"]:4},Bo=s=>{let e={},r={},i=0;return D({[d.Pair]:c=>{let[l]=c.params,m=l.value,h=c.params[1].value;I(e[m]==null,`Duplicate key ${m} not allowed in object type`),r[m]=`${l.Type==="AddressOf"?"&":""}${h}`,e[m]=i,i+=Ro[h]||4}})(s),[e,i,r]},ko=s=>(e,r)=>{let i=s`throw;`,c={load:W({range:r.range},s`i32.load(${i}, ${i});`),store:M=>W({range:r.range},s`i32.store(${i}, ${M});`),offset:i,type:"void"};if(e.meta.STRUCT_TYPE==null)return c;let l=e.meta.STRUCT_TYPE,m=l.meta.TYPE_OBJECT,h=l.meta.OBJECT_KEY_TYPES,p=m[r.value];if(p==null)return c;let v=h[r.value],b=v[0]==="&",g=p?s`(${e} + ${p});`:s`(${e});`,A=null,L=null;v!=null&&typeof v=="object"&&(A=v,v=jt),String(v).endsWith("[]")&&(L=v.slice(0,-2).replace("&",""),v="i32");let R=W({range:e.range,meta:{STRUCT_TYPE:A,TYPE_ARRAY:L}});return{offset:g,type:v,store:M=>R(s`${v}.store(${g}, ${M});`),load:R(b?g:s`${v}.load(${g});`)}};function Fo(){return{semantics({stmt:s}){let e=ko(s);function r(c,l){let[m,h]=c,[p,v]=m.params,[b,g]=p.params,A=e(l([b,h]),g);return l([A.store(v),h])}function i(c,l){let[m,h]=c,[p,v]=m.params,b=l([p,h]),g=[];D({[d.Identifier]:(L,R)=>{let M=e(b,L);g.push({field:M,value:L})},[d.Pair]:(L,R)=>{let[M,z]=L.params,X=e(b,M);g.push({field:X,value:z})},[d.Spread]:(L,R)=>{let M=l([L.params[0],h]);Object.keys(M.meta.TYPE_OBJECT).forEach(z=>{let X=e(b,{value:z,type:null,range:M.range}),Q=e(M,{value:z,type:null,range:M.range});g.push({field:X,value:Q.load})})}})(v);let A=g.filter(({field:L})=>L!=null).map(L=>l([L.field.store(L.value),h]));return P({},p,{Type:d.Block,params:A})}return{[d.Struct]:c=>([l,m],h)=>{let{userTypes:p,aliases:v}=m,[b]=l.params,g=P({},l,{meta:P({},l.meta,{TYPE_OBJECT:{},OBJECT_SIZE:0,OBJECT_KEY_TYPES:{}})}),A=()=>{v[l.value]=b.value},L=(M,z)=>{let[X,Q,$e]=Bo(M);g.meta.TYPE_OBJECT=P({},g.meta.TYPE_OBJECT,X),g.meta.OBJECT_SIZE+=Q,g.meta.OBJECT_KEY_TYPES=P({},g.meta.OBJECT_KEY_TYPES,$e)};return{[d.Type]:A,[d.Identifier]:A,[d.ObjectLiteral]:()=>{L(l),p[g.value]=g},[d.UnionType]:()=>{D({[d.ObjectLiteral]:L,[d.ArrayType]:M=>{g.meta.TYPE_ARRAY=M.type.slice(0,-2)},[d.Identifier]:M=>{let z=p[h([M,m]).value];g.meta.TYPE_OBJECT=P({},g.meta.TYPE_OBJECT,z.meta.TYPE_OBJECT),g.meta.OBJECT_SIZE=Math.max(g.meta.OBJECT_SIZE,z.meta.OBJECT_SIZE),g.meta.OBJECT_KEY_TYPES=P({},g.meta.OBJECT_KEY_TYPES,z.meta.OBJECT_KEY_TYPES)}})(b),p[g.value]=g}}[b.Type](),g.meta.OBJECT_KEY_TYPES=Object.entries(g.meta.OBJECT_KEY_TYPES).reduce((M,[z,X])=>(M[z]=p[X]||X,M),{}),g},[d.DeclType]:c=>(l,m)=>{let[h,p]=l,{aliases:v}=p;return v[h.value]?m([W({value:v[h.value],type:v[h.value]},h),p]):c(l)},[d.FunctionResult]:c=>(l,m)=>{let[h,p]=l,{userTypes:v,aliases:b}=p;return b[h.type]?m([W({type:b[h.type]},h),p]):v[String(h.type)]?c([W({type:jt,meta:{STRUCT_TYPE:v[h.type]},params:h.params.map(g=>m([g,p]))},h),p]):c(l)},[d.Identifier]:c=>l=>{let[m,h]=l,{userTypes:p,scopes:v}=h,b=Je(v,m.value);return b&&p[b.type]?P({},m,{meta:P({},m.meta,b.meta,p[b.type].meta,{STRUCT_TYPE:p[b.type]}),type:jt}):c(l)},[d.Access]:function(c){return(l,m)=>{let[h,p]=l,[v,b]=h.params,g=e(m([v,p]),b);return m([g.load,p])}},[d.Assignment]:c=>(l,m)=>{let[h]=l,[p,v]=h.params;return p.Type===d.Access?r(l,m):v.Type===d.ObjectLiteral?i(l,m):c(l)},[d.ArraySubscript]:c=>(l,m)=>{let[h,p]=l,v=c(l);if(p.userTypes[v.meta.TYPE_ARRAY]==null)return v;let[b,g]=h.params.map(A=>m([A,p]));return m([W({type:jt,meta:{STRUCT_TYPE:p.userTypes[v.meta.TYPE_ARRAY]}},s`(${b} + (${g} * sizeof(${v.meta.TYPE_ARRAY})));`),p])}}}}}function Mo(){return{semantics(){return{[d.FunctionCall]:s=>(e,r)=>{let[i,c]=e,[l,...m]=i.params;if(l.Type===d.Access&&l.params[0]&&l.params[0].Type===d.Type){let[h,p]=l.params;return W({value:`${h.value}.${p.value}`,type:h.value,params:m.map(v=>r([v,c])),Type:d.NativeMethod},i)}return s(e)},[d.Unreachable]:s=>([e])=>W({value:"unreachable",params:[],Type:d.NativeMethod},e)}}}}function jo(){return{grammar:Hn,semantics(){return{[d.FunctionDeclaration]:s=>e=>{let[r,i]=e,[c]=r.params,l=[];return D({Assignment:m=>{let[,h]=m.params;l.push(h)}})(c),s([P({},r,{meta:P({},r.meta,{DEFAULT_ARGUMENTS:l})}),i])},[d.FunctionCall]:s=>e=>{let[r,i]=e,{functions:c}=i,[l,...m]=r.params,h=c[l.value];if(!h)return s(e);let p=h.meta.FUNCTION_METADATA.argumentsCount,v=m.length,b=p-v;return b>0?s([P({},r,{params:[...r.params,...h.meta.DEFAULT_ARGUMENTS.slice(b-1)]}),i]):s(e)}}}}}let Uo={i64:8,f64:8,i32:4,f32:4};function Do(){return{semantics(){return{[d.FunctionCall]:s=>e=>{let[r,i]=e;if(r.value!=="sizeof")return s(e);let{scopes:c,userTypes:l,functions:m}=i,[,h]=r.params,p=Je(c,h.value),{type:v=""}=p||{},b=l[h.value]||l[v],g=m[h.value];if(b!=null){let L=b.meta[co];return I(L,"Object size information is missing"),P({},r,{value:L,params:[],type:"i32",Type:d.Constant})}let A=p||g;return P({},r,{value:Uo[String(A?A.type:h.value)],type:"i32",params:[],Type:d.Constant})}}}}}let zo=()=>[uo().semantics,lo().semantics,bo().semantics,po().semantics,ho().semantics,yo().semantics,_o().semantics,Eo().semantics,Ao().semantics,Io().semantics,No().semantics,Fo().semantics,Mo().semantics,Do().semantics,jo().semantics];function cn(s,e,r){let i=[...zo(),...e],c=qs(i.map(R=>R(r))),l={functions:{},types:{},userTypes:{},table:{},hoist:[],statics:{},path:[],scopes:tr([],Le),memories:[],tables:[],aliases:{},exports:{}},m=w(c)([s,l]),{functions:h,scopes:p,types:v,userTypes:b,statics:g,hoist:A,exports:L}=l;return P({},m,{meta:P({},m.meta,{[tn]:{functions:h,globals:p[0],types:v,userTypes:b,statics:g,exports:L}}),params:[...m.params,...A]})}function we(s,e,r,i,c){let l=r.start.line,m=r.start.col,h=r.end.col,p=r.end.sourceLine,v=new Array(h-m+1).join("^").padStart(r.start.col-1," ");return`
`+p+`
`+v+` ${e}
`+s+`
  at ${c} (${i}:${l}:${m})`}let k={},Go=[],ln={},x=null,S=(s,e,r,i,c,l,m)=>{let h={result:s,first:e,second:r,size:i,code:c,name:l,text:m};return k[l]=h,Go[c]=h,ln[m]=h,h};S(x,x,x,0,0,"Unreachable","unreachable"),S(x,x,x,0,1,"Nop","nop"),S(x,x,x,0,2,"Block","block"),S(x,x,x,0,3,"Loop","loop"),S(x,x,x,0,4,"If","if"),S(x,x,x,0,5,"Else","else"),S(x,x,x,0,6,"Try","try"),S(x,x,x,0,7,"Catch","catch"),S(x,x,x,0,8,"Throw","throw"),S(x,x,x,0,9,"Rethrow","rethrow"),S(x,x,x,0,10,"CatchAll","catch_all"),S(x,x,x,0,11,"End","end"),S(x,x,x,0,12,"Br","br"),S(x,x,x,0,13,"BrIf","br_if"),S(x,x,x,0,14,"BrTable","br_table"),S(x,x,x,0,15,"Return","return"),S(x,x,x,0,16,"Call","call"),S(x,x,x,0,17,"CallIndirect","call_indirect"),S(x,x,x,0,26,"Drop","drop"),S(x,x,x,0,27,"Select","select"),S(x,x,x,0,32,"GetLocal","get_local"),S(x,x,x,0,33,"SetLocal","set_local"),S(x,x,x,0,34,"TeeLocal","tee_local"),S(x,x,x,0,35,"GetGlobal","get_global"),S(x,x,x,0,36,"SetGlobal","set_global"),S(T,T,x,4,40,"i32Load","i32.load"),S(O,T,x,8,41,"i64Load","i64.load"),S($,T,x,4,42,"f32Load","f32.load"),S(oe,T,x,8,43,"f64Load","f64.load"),S(T,T,x,1,44,"i32Load8S","i32.load8_s"),S(T,T,x,1,45,"i32Load8U","i32.load8_u"),S(T,T,x,2,46,"i32Load16S","i32.load16_s"),S(T,T,x,2,47,"i32Load16U","i32.load16_u"),S(O,T,x,1,48,"i64Load8S","i64.load8_s"),S(O,T,x,1,49,"i64Load8U","i64.load8_u"),S(O,T,x,2,50,"i64Load16S","i64.load16_s"),S(O,T,x,2,51,"i64Load16U","i64.load16_u"),S(O,T,x,4,52,"i64Load32S","i64.load32_s"),S(O,T,x,4,53,"i64Load32U","i64.load32_u"),S(x,T,T,4,54,"i32Store","i32.store"),S(x,T,O,8,55,"i64Store","i64.store"),S(x,T,$,4,56,"f32Store","f32.store"),S(x,T,$,8,57,"f64Store","f64.store"),S(x,T,T,1,58,"i32Store8","i32.store8"),S(x,T,T,2,59,"i32Store16","i32.store16"),S(x,T,O,1,60,"i64Store8","i64.store8"),S(x,T,O,2,61,"i64Store16","i64.store16"),S(x,T,O,4,62,"i64Store32","i64.store32"),S(T,x,x,0,63,"CurrentMemory","current_memory"),S(T,T,x,0,64,"GrowMemory","grow_memory"),S(T,x,x,0,65,"i32Const","i32.const"),S(O,x,x,0,66,"i64Const","i64.const"),S($,x,x,0,67,"f32Const","f32.const"),S(oe,x,x,0,68,"f64Const","f64.const"),S(T,T,x,0,69,"i32Eqz","i32.eqz"),S(T,T,T,0,70,"i32Eq","i32.eq"),S(T,T,T,0,71,"i32Ne","i32.ne"),S(T,T,T,0,72,"i32LtS","i32.lt_s"),S(T,T,T,0,73,"i32LtU","i32.lt_u"),S(T,T,T,0,74,"i32GtS","i32.gt_s"),S(T,T,T,0,75,"i32GtU","i32.gt_u"),S(T,T,T,0,76,"i32LeS","i32.le_s"),S(T,T,T,0,77,"i32LeU","i32.le_u"),S(T,T,T,0,78,"i32GeS","i32.ge_s"),S(T,T,T,0,79,"i32GeU","i32.ge_u"),S(T,O,x,0,80,"i64Eqz","i64.eqz"),S(T,O,O,0,81,"i64Eq","i64.eq"),S(T,O,O,0,82,"i64Ne","i64.ne"),S(T,O,O,0,83,"i64LtS","i64.lt_s"),S(T,O,O,0,84,"i64LtU","i64.lt_u"),S(T,O,O,0,85,"i64GtS","i64.gt_s"),S(T,O,O,0,86,"i64GtU","i64.gt_u"),S(T,O,O,0,87,"i64LeS","i64.le_s"),S(T,O,O,0,88,"i64LeU","i64.le_u"),S(T,O,O,0,89,"i64GeS","i64.ge_s"),S(T,O,O,0,90,"i64GeU","i64.ge_u"),S(T,$,$,0,91,"f32Eq","f32.eq"),S(T,$,$,0,92,"f32Ne","f32.ne"),S(T,$,$,0,93,"f32Lt","f32.lt"),S(T,$,$,0,94,"f32Gt","f32.gt"),S(T,$,$,0,95,"f32Le","f32.le"),S(T,$,$,0,96,"f32Ge","f32.ge"),S(T,$,$,0,97,"f64Eq","f64.eq"),S(T,$,$,0,98,"f64Ne","f64.ne"),S(T,$,$,0,99,"f64Lt","f64.lt"),S(T,$,$,0,100,"f64Gt","f64.gt"),S(T,$,$,0,101,"f64Le","f64.le"),S(T,$,$,0,102,"f64Ge","f64.ge"),S(T,T,x,0,103,"i32Clz","i32.clz"),S(T,T,x,0,104,"i32Ctz","i32.ctz"),S(T,T,x,0,105,"i32Popcnt","i32.popcnt"),S(T,T,T,0,106,"i32Add","i32.add"),S(T,T,T,0,107,"i32Sub","i32.sub"),S(T,T,T,0,108,"i32Mul","i32.mul"),S(T,T,T,0,109,"i32DivS","i32.div_s"),S(T,T,T,0,110,"i32DivU","i32.div_u"),S(T,T,T,0,111,"i32RemS","i32.rem_s"),S(T,T,T,0,112,"i32RemU","i32.rem_u"),S(T,T,T,0,113,"i32And","i32.and"),S(T,T,T,0,114,"i32Or","i32.or"),S(T,T,T,0,115,"i32Xor","i32.xor"),S(T,T,T,0,116,"i32Shl","i32.shl"),S(T,T,T,0,117,"i32ShrS","i32.shr_s"),S(T,T,T,0,118,"i32ShrU","i32.shr_u"),S(T,T,T,0,119,"i32Rotl","i32.rotl"),S(T,T,T,0,120,"i32Rotr","i32.rotr"),S(O,O,x,0,121,"i64Clz","i64.clz"),S(O,O,x,0,122,"i64Ctz","i64.ctz"),S(O,O,x,0,123,"i64Popcnt","i64.popcnt"),S(O,O,O,0,124,"i64Add","i64.add"),S(O,O,O,0,125,"i64Sub","i64.sub"),S(O,O,O,0,126,"i64Mul","i64.mul"),S(O,O,O,0,127,"i64DivS","i64.div_s"),S(O,O,O,0,128,"i64DivU","i64.div_u"),S(O,O,O,0,129,"i64RemS","i64.rem_s"),S(O,O,O,0,130,"i64RemU","i64.rem_u"),S(O,O,O,0,131,"i64And","i64.and"),S(O,O,O,0,132,"i64Or","i64.or"),S(O,O,O,0,133,"i64Xor","i64.xor"),S(O,O,O,0,134,"i64Shl","i64.shl"),S(O,O,O,0,135,"i64ShrS","i64.shr_s"),S(O,O,O,0,136,"i64ShrU","i64.shr_u"),S(O,O,O,0,137,"i64Rotl","i64.rotl"),S(O,O,O,0,138,"i64Rotr","i64.rotr"),S($,$,$,0,139,"f32Abs","f32.abs"),S($,$,$,0,140,"f32Neg","f32.neg"),S($,$,$,0,141,"f32Ceil","f32.ceil"),S($,$,$,0,142,"f32Floor","f32.floor"),S($,$,$,0,143,"f32Trunc","f32.trunc"),S($,$,$,0,144,"f32Nearest","f32.nearest"),S($,$,$,0,145,"f32Sqrt","f32.sqrt"),S($,$,$,0,146,"f32Add","f32.add"),S($,$,$,0,147,"f32Sub","f32.sub"),S($,$,$,0,148,"f32Mul","f32.mul"),S($,$,$,0,149,"f32Div","f32.div"),S($,$,$,0,150,"f32Min","f32.min"),S($,$,$,0,151,"f32Max","f32.max"),S($,$,$,0,152,"f32Copysign","f32.copysign"),S($,$,$,0,153,"f32Abs","f64.abs"),S($,$,$,0,154,"f32Neg","f64.neg"),S($,$,$,0,155,"f32Ceil","f64.ceil"),S($,$,$,0,156,"f32Floor","f64.floor"),S($,$,$,0,157,"f32Trunc","f64.trunc"),S($,$,$,0,158,"f32Nearest","f64.nearest"),S($,$,$,0,159,"f32Sqrt","f64.sqrt"),S(oe,oe,oe,0,160,"f64Add","f64.add"),S(oe,oe,oe,0,161,"f64Sub","f64.sub"),S(oe,oe,oe,0,162,"f64Mul","f64.mul"),S(oe,oe,oe,0,163,"f64Div","f64.div"),S(oe,oe,oe,0,164,"f64Min","f64.min"),S(oe,oe,oe,0,165,"f64Max","f64.max"),S(oe,oe,oe,0,166,"f64Copysign","f64.copysign"),S(T,O,x,0,167,"i32Wrapi64","i32.wrap/i64"),S(T,$,x,0,168,"i32TruncSf32","i32.trunc_s/f32"),S(T,$,x,0,169,"i32TruncUf32","i32.trunc_u/f32"),S(T,$,x,0,170,"i32TruncSf64","i32.trunc_s/f64"),S(T,$,x,0,171,"i32TruncUf64","i32.trunc_u/f64"),S(O,T,x,0,172,"i64ExtendSi32","i64.extend_s/i32"),S(O,T,x,0,173,"i64ExtendUi32","i64.extend_u/i32"),S(O,$,x,0,174,"i64TruncSf32","i64.trunc_s/f32"),S(O,$,x,0,175,"i64TruncUf32","i64.trunc_u/f32"),S(O,$,x,0,176,"i64TruncSf64","i64.trunc_s/f64"),S(O,$,x,0,177,"i64TruncUf64","i64.trunc_u/f64"),S($,T,x,0,178,"f32ConvertSi32","f32.convert_s/i32"),S($,T,x,0,179,"f32ConvertUi32","f32.convert_u/i32"),S($,O,x,0,180,"f32ConvertSi64","f32.convert_s/i64"),S($,O,x,0,181,"f32ConvertUi64","f32.convert_u/i64"),S($,$,x,0,182,"f32Demotef64","f32.demote/f64"),S($,T,x,0,183,"f64ConvertSi32","f64.convert_s/i32"),S($,T,x,0,184,"f64ConvertUi32","f64.convert_u/i32"),S($,O,x,0,185,"f64ConvertSi64","f64.convert_s/i64"),S($,O,x,0,186,"f64ConvertUi64","f64.convert_u/i64"),S($,$,x,0,187,"f64Promotef32","f64.promote/f32"),S(T,$,x,0,188,"i32Reinterpretf32","i32.reinterpret/f32"),S(O,$,x,0,189,"i64Reinterpretf64","i64.reinterpret/f64"),S($,T,x,0,190,"f32Reinterpreti32","f32.reinterpret/i32"),S($,O,x,0,191,"f32Reinterpreti64","f64.reinterpret/i64");let lr=(s,e)=>{let r=s[0];return["i32","bool"].includes(s)&&e==="i64"?k.i32Wrapi64:s==="i64"&&["i32","bool"].includes(e)?k.i64ExtendSi32:s==="f32"&&e==="f64"?k.f32Demotef64:s==="f64"&&e==="f32"?k.f64Promotef32:k[s+(r==="f"?"ConvertS":"TruncS")+e]},ur=({type:s,value:e})=>({"+":k[String(s)+"Add"],"-":k[String(s)+"Sub"],"*":k[String(s)+"Mul"],"/":k[String(s)+"DivS"]||k[String(s)+"Div"],"%":k[String(s)+"RemS"]||k[String(s)+"RemU"],"==":k[String(s)+"Eq"],"!=":k[String(s)+"Ne"],">":k[String(s)+"Gt"]||k[String(s)+"GtS"],"<":k[String(s)+"Lt"]||k[String(s)+"LtS"],"<=":k[String(s)+"Le"]||k[String(s)+"LeS"],">=":k[String(s)+"Ge"]||k[String(s)+"GeS"],"?":k.If,":":k.Else,"&":k[String(s)+"And"],"|":k[String(s)+"Or"],"^":k[String(s)+"Xor"],">>":k[String(s)+"ShrS"],">>>":k[String(s)+"ShrU"],"<<":k[String(s)+"Shl"]})[e],Qe=127,He=126,Ke=125,Xe=124,pr=112,fr=96,Yo={i32:Qe,i64:He,f32:Ke,f64:Xe},Ut=s=>{switch(s){case He:return"i64";case Ke:return"f32";case Xe:return"f64";case fr:return"func";case pr:return"anyfunc";case Qe:default:return"i32"}},un=s=>{let e={};return D({[d.Pair]:({params:r})=>{let[{value:i},{value:c}]=r;e[i]=parseInt(c)}})(s),e},qo=s=>{let e=s.value||"??",r=s.type,i=ur({value:e,type:r||"i32"});return r?i.text:i.text.replace("i32","??")},mr=s=>{let e=[];return D({[d.Pair]:(r,i)=>{e.push(`${r.params[0].value} ${r.params[1].value}`)},[d.Type]:r=>{e.push(r.value)}})(s),e.length?" param("+e.join(" ")+")":""},hr=s=>s==null?"":" (result "+(s.type||"??")+")",yr=s=>{let[e,r]=s.params;return"(type "+s.value+` (func${mr(e)}${hr(r)}))`},Fe=(s,e,{value:r,params:i})=>{i.filter(Boolean).length?(s(`(${r}`,2),i.forEach(e),s(")",0,-2)):s(`(${r})`,0,0)},Vo=s=>({[d.Import]:(e,r)=>{let[i,c]=e.params;D({[d.Pair]:({params:l},m)=>{let{value:h}=l[0],p=l[1];if(p.value==="Memory"){let v=un(p);s(`(import "${c.value}" "${h}" (memory ${v.initial}${v.max?v.max:""}))`)}else s(`(import "${c.value}" "${h}" ${yr(p)})`)},[d.Identifier]:(l,m)=>{let{value:h}=l;s(`(import "${c.value}" "${h}" (type ??))`)}})(i)},[d.Export]:(e,r)=>{s("(export",2),e.params.forEach(r),s(")",0,-2)},[d.GenericType]:(e,r)=>{s(";; Pseudo type",0,0),s("(type-generic "+e.value+")",0,0)},[d.FunctionCall]:({value:e,params:r},i)=>{Fe(s,i,{value:`call ${e}`,params:r})},[d.Block]:({params:e},r)=>{Fe(s,r,{value:"block",params:e})},[d.NativeMethod]:(e,r)=>{Fe(s,r,e)},[d.BinaryExpression]:(e,r)=>{let i=qo(e);Fe(s,r,{value:i,params:e.params})},[d.ArraySubscript]:({params:e},r)=>{s(";; unparsed",0,0),Fe(s,r,{value:"subscript",params:e})},[d.Typedef]:(e,r)=>{s(yr(e))},[d.Struct]:(e,r)=>{s(";; Pseudo struct type",0,0),Fe(s,r,{value:"type-struct "+e.value,params:e.params})},[d.Identifier]:e=>{let r=e.meta[Le]!=null?"global":"local";s(`(get_${r} ${e.value})`)},[d.Constant]:e=>{s(`(${String(e.type)}.const ${e.value})`)},[d.FunctionPointer]:e=>{s(`(${String(e.type)}.table_pointer ${e.value})`)},[d.FunctionDeclaration]:(e,r)=>{let[i,c,...l]=e.params;s(`(func ${e.value}${mr(i)}${hr(c)}`,2),l.forEach(r),s(")",0,-2)},[d.ReturnStatement]:({params:e},r)=>{Fe(s,r,{value:"return",params:e})},[d.Declaration]:(e,r)=>{s("(local "+e.value+" "+String(e.type),2,0),e.params.forEach(r),s(")",0,-2)},[d.ImmutableDeclaration]:(e,r)=>{let i=e.meta[Le]!=null?"global":"local";if(e.type==="Memory"){let c=un(e);s(`(memory ${c.initial}${c.max?` ${c.max}`:""})`)}else s(`(${i} `+e.value+" "+String(e.type),2,0),e.params.forEach(r),s(")",0,-2)},[d.StringLiteral]:e=>{s(`; string "${e.value}"`,0,0),s("(i32.const ??)",0,0)},[d.Type]:e=>{s(e.value)},[d.TypeCast]:(e,r)=>{let i=e.params[0],c=lr(String(e.type),i.type);s("("+c.text,2),e.params.forEach(r),s(")",0,-2)},[d.Access]:({params:e},r)=>{s(";; unparsed",0,0),Fe(s,r,{value:"access",params:e})},[d.MemoryAssignment]:(e,r)=>{s("("+String(e.type)+".store",2,0),e.params.forEach(r),s(")",0,-2)},[d.Assignment]:(e,r)=>{let[i,...c]=e.params,l=i.meta[Le]!=null?"global":"local";s(`(set_${l} ${i.value}`,2),[d.ArraySubscript,d.Access].includes(i.Type)&&r(i),c.forEach(r),s(")",0,-2)},[d.TernaryExpression]:(e,r)=>{let[i,c,l]=e.params;s("(select",2),r(i),r(c),r(l),s(")",0,-2)},[d.IfThenElse]:(e,r)=>{let[i,c,...l]=e.params;s("(if",2),r(i),s("(then",2),r(c),s(")",0,-2),l.length>0&&(s("(else",2),l.forEach(r),s(")",0,-2)),s(")",0,-2)},[d.ObjectLiteral]:(e,r)=>{}}),dr=s=>{if(s==null)return"";let e=0,r=[],i=[];return D(Vo((m,h=0,p=0)=>{e+=p,i.push(m),r.push(e+m.length),e+=h}))(s),i.reduce((m,h,p)=>(m+=h.padStart(r[p]," ")+`
`,m),"")},br=At((s,e)=>{let r=e.meta[wt],i=e.meta[Le],c=r!=null?r:i;I(c!=null,`Undefined index for scope Operation. Possibly missing metadata. op: ${JSON.stringify(s)} node: ${dr(e)}`);let l=r!=null?s+"Local":s+"Global",m=[Number(c)];return{kind:k[l],params:m,debug:`${e.value}<${e.meta.ALIAS||e.type}>`}}),Jo=s=>{switch(s){case he.f32:return Ke;case he.f64:return Xe;case he.i64:return He;case he.i32:default:return Qe}},mt=s=>typeof s=="string"&&he[s]!=null,_r=s=>({mutable:s.meta[$t]?0:1,type:Jo(s.type)}),Wo=br("Set"),gr=br("Get"),Dt="global";function pn(s,{filename:e}){let r=s.meta[tn];if(r==null)throw new Error("Missing AST metadata!");let{types:i,functions:c,userTypes:l}=r,m=[];D({[d.Import]:(p,v)=>{D({[d.BinaryExpression]:(b,g)=>{let[A,L]=b.range;m.push(we("Using an 'as' import without a type.","A type for original import "+b.params[0].value+" is not defined nor could it be inferred.",{start:A,end:L},e,Dt))},[d.Identifier]:(b,g)=>{let[A,L]=b.range;m.push(we("Infered type not supplied.","Looks like you'd like to infer a type, but it was never provided by a linker. Non-concrete types cannot be compiled.",{start:A,end:L},e,Dt))},[d.Pair]:(b,g)=>{let A=b.params[1];if(!mt(A.value)&&i[A.value]==null){let[L,R]=A.range;m.push(we(`Undefined Type ${A.value}`,`Invalid Import. ${A.value} type does not exist`,{start:L,end:R},e,Dt))}}})(p)},[d.Struct]:(p,v)=>{},[d.ImmutableDeclaration]:(p,v)=>{},[d.Declaration]:(p,v)=>{let[b,g]=p.range;!mt(p.type)&&!i[p.type]&&!l[p.type]&&m.push(we(`Unknown type used in a declaration, "${String(p.type)}"`,"Variables must be assigned with a known type.",{start:b,end:g},e,Dt))},[d.FunctionDeclaration]:(p,v)=>{let b=`${p.value}()`;D({[d.Declaration]:(g,A)=>{let[L,R]=g.range;!mt(g.type)&&!i[g.type]&&!l[g.type]&&m.push(we(`Unknown type used in a declartion, "${String(g.type)}"`,"Variables must be assigned with a known type.",{start:L,end:R},e,b))},[d.Assignment]:g=>{let[A]=g.params,[L,R]=g.range;A.meta[$t]&&m.push(we(`Cannot reassign a const variable ${A.value}`,"const variables cannot be reassigned, use let instead.",{start:L,end:R},e,b))},[d.ArraySubscript]:g=>{let[A]=g.params,[L,R]=g.range;m.push(we("Invalid subscript target",`Expected array type for ${A.value}, received ${A.type}`,{start:L,end:R},e,b))},[d.NativeMethod]:(g,A)=>{let{value:L}=g,[R={},M]=g.params,[z,X]=g.range;R.value==="unreachable"&&(L.includes("store")||L.includes("load"))&&m.push(we("Cannot generate property access",`Cannot assign "${M.value}". Key is "${R.value}"`,{start:z,end:X},e,b))},[d.ReturnStatement]:(g,A)=>{if(g.params.map(A),p.type==null)return;let[L]=g.params,[R]=g.range,M=L!=null?L.range[1]:g.range[1],z=g.type;ke(z)!==ke(p.type)&&m.push(we("Missing return value","Inconsistent return value. Expected "+p.type+" received "+String(z),{start:R,end:M},e,b))},[d.FunctionCall]:(g,A)=>{if(c[g.value]==null){let[L,R]=g.range;m.push(we("Undefined function reference",`${g.value} is not defined.`,{start:L,end:R},e,b))}},[d.IndirectFunctionCall]:(g,A)=>{let L=g.params[g.params.length-1],R=i[L.type];if(!mt(L.type)&&R==null){let[M,z]=g.range;m.push(we("Cannot make an indirect call without a valid function type",`${L.value} has type ${String(L.type)} which is not defined. Indirect calls must have pre-defined types.`,{start:M,end:z},e,b))}}})(p)}})(s);let h=m.length;if(h>0){let p=m.reduce((v,b)=>v+`
${b}
`,`Cannot generate WebAssembly for ${e}. ${h} problems.
`);throw new Error(p)}}let ue=(s,e)=>(Array.isArray(e)?s=[...s,...e]:s.push(e),s),Qo=(s,e)=>{let r=s.params.map(fe(e)).reduce(ue,[]),i=s.meta[Oe];return r.push({kind:k.Call,params:[i],debug:`${s.value}<${s.type?s.type:"void"}>`}),r},Ho=(s,e)=>{let r=s.params.map(fe(e)).reduce(ue,[]),i=s.meta[wt],c=s.meta[ft];return I(i!=null,"Undefined local index, not a valid function pointer"),I(c!=null,"Variable is not of a valid function pointer type"),[...r,{kind:k.CallIndirect,params:[c,0]}]},Ko=(s,e)=>{let r=s.params.map(fe(e)).reduce(ue,[]);return r.push({kind:ur(P({},s,{type:s.type})),params:[]}),r},Xo=(s,e)=>{let r=s.params.map(fe(e)).reduce(ue,[]);return r.push({kind:k.Select,params:[]}),r},Zo=(s,e)=>{let r=fe(e),[i,c,...l]=s.params;return[...[i].map(r).reduce(ue,[]),{kind:k.If,params:[64]},...[c].map(r).reduce(ue,[]),...l.map(r).reduce(ue,[]),{kind:k.End,params:[]}]},ea=s=>[{kind:k.i32Const,params:[Number(s.value)]}],ta=s=>{let e=s.params.filter(Boolean).map(fe(null)).reduce(ue,[]);return e.push({kind:k.Return,params:[]}),e},na=(s,e)=>[s].map(fe(e)).reduce(ue,[]),ra=(s,e)=>{let r=s.params[0];if(r){let i=s.meta[wt],c=mt(s.type)?s.type:pt;return[...na(P({},r,{type:c}),e),{kind:k.SetLocal,params:[i],debug:`${s.value}<${String(s.type)}>`}]}return[]},sa=s=>{let[e,r]=s.params,i=[r].map(fe(null)).reduce(ue,[]);return i.push(Wo(e)),i},oa=s=>{let[e,r]=s.params,i=[r].map(fe(null)).reduce(ue,[]);return i.push({kind:k.TeeLocal,params:[Number(e.meta.LOCAL_INDEX)],debug:`${e.value}<${String(e.meta.ALIAS||e.type)}>`}),i},aa=(s,e)=>{let r=[],i=fe(e),[c,l,...m]=s.params;return r.push.apply(r,[c].map(i).reduce(ue,[])),r.push({kind:k.Block,params:[64]}),r.push({kind:k.Loop,params:[64]}),r.push.apply(r,[l].map(i).reduce(ue,[])),r.push({kind:k.i32Eqz,params:[]}),r.push({kind:k.BrIf,params:[1]}),r.push.apply(r,m.map(i).reduce(ue,[])),r.push({kind:k.Br,params:[0]}),r.push({kind:k.End,params:[]}),r.push({kind:k.End,params:[]}),r},ia=(s,e)=>{let r=s.meta[en];I(r,`Cannot generate typecast for node: ${JSON.stringify(s)}`);let{to:i,from:c}=r;return[...s.params.map(fe(e)).reduce(ue,[]),{kind:lr(i,c),params:[]}]},ca=()=>[{kind:k.Br,params:[2]}];function la(){return[]}let ua=(s,e)=>s.params.map(fe(e)).reduce(ue,[]),pa=(s,e)=>[{kind:k.Else,params:[]},...s.params.map(fe(e)).reduce(ue,[])],fa=(s,e)=>{let[r,i]=s.params,c={kind:k.Select,params:[]},l=[r].map(fe(e)).reduce(ue,[]);return s.value==="&&"?[...[i].map(fe(e)).reduce(ue,[]),{kind:k.i32Const,params:[0]},...l,c]:[...l,...[i].map(fe(e)).reduce(ue,[]),...l,c]},vr={load8_s:0,load8_u:0,store8:0,load16_s:1,load16_u:1,store16:1,store32:2,load32_s:2,load32_u:2,store:2,load:2},ma={grow_memory:0,current_memory:0},ha=(s,e)=>{let r=s.params.map(fe(e)).reduce(ue,[]),i=s.value.split(".").pop();if(vr[i]==null)r.push({kind:ln[s.value],params:[ma[s.value]]});else{let c=vr[i];r.push({kind:ln[s.value],params:[c,0]})}return r},ya=s=>{let e=k[String(s.type)+"Const"],r=(s.meta.SIGN||1)*Number(s.value);return[{kind:e,params:[r]}]},da={[d.FunctionCall]:Qo,[d.IndirectFunctionCall]:Ho,[d.Constant]:ya,[d.BinaryExpression]:Ko,[d.TernaryExpression]:Xo,[d.IfThenElse]:Zo,[d.Else]:pa,[d.Select]:fa,[d.Block]:ua,[d.Identifier]:gr,[d.FunctionIdentifier]:gr,[d.FunctionPointer]:ea,[d.ReturnStatement]:ta,[d.Declaration]:ra,[d.Assignment]:sa,[d.AssignmentExpression]:oa,[d.Loop]:aa,[d.Break]:ca,[d.TypeCast]:ia,[d.Noop]:la,[d.NativeMethod]:ha},fe=At((s,e)=>{let r=da[e.Type];return I(r,`Unsupported Syntax Token. ${e.Type} "${e.value}"`),r(e,s)}),ba=s=>({functionIndex:s}),fn=0,zt=1,Gt=2,ht=3,_a={Memory:Gt,Table:zt};function ga(s){let e=s.meta[Oe],r=s.meta[Le];if(r!=null){let i=_a[String(s.type)]||ht;return{index:[Gt,zt].includes(i)?0:r,kind:i,field:s.value}}return{index:e,kind:fn,field:s.value}}let va=s=>{let e={max:0,initial:0};return D({[d.Pair]:({params:r})=>{let[{value:i},{value:c}]=r;e[i]=parseInt(c)}})(s),e};function Sa(s){let e={max:0,initial:0,type:"element"};return D({[d.Pair]:({params:r})=>{let[{value:i},{value:c}]=r;switch(i){case"initial":e.initial=parseInt(c);break;case"element":e.type=c;break;case"max":e.max=parseInt(c);break}}})(s),e}let Ta=s=>{let e=_r(s),[r]=s.params;if(r!=null){let{value:i}=r;switch(e.type){case Ke:case Xe:e.init=parseFloat(i);break;case Qe:case He:default:e.init=parseInt(i)}}return e},Ea=s=>{switch(s){case"Memory":return Gt;case"Table":return zt;case"i32":case"f32":case"i64":case"f64":return ht;default:return fn}},xa=s=>{let e=s.value;return s.meta.AS!=null?s.meta.AS:e};function Aa(s){let[e,r]=s.params,{value:i}=r,c=[];return D({[d.Pair]:(l,m)=>{let[h,p]=l.params,v=xa(h),{value:b}=p,g=Ea(b),A=(()=>{let R=p.meta[ft];return R||null})(),L=b==="Memory"?un(p):{};c.push(P({module:i,field:v,global:g===ht,kind:g,type:Yo[b],typeIndex:A},L))}})(e),c}let Ze=s=>{switch(s){case"f32":return Ke;case"f64":return Xe;case"i64":return He;case"i32":case"Function":default:return Qe}},Sr=s=>{let[e]=s.params,r=s.type?Ze(s.type):null,i=[];return D({[d.Pair]:c=>{let l=c.params[1];I(l,"Undefined type in a argument expression"),i.push(Ze(l.value))}})(e),{params:i,result:r,id:s.value}};function wa(s){let e=s.value;I(typeof e=="string",`Generator: A type must have a valid string identifier, node: ${JSON.stringify(s)}`);let[r,i]=s.params,c=[];return D({[d.DeclType]:(l,m)=>{c.push(Ze(l.value))},[d.Type]:(l,m)=>{c.push(Ze(l.value))},[d.Identifier]:(l,m)=>{c.push(Ze(l.value))}})(r),{id:e,params:c,result:i.type&&i.type!=="void"?Ze(i.type):null}}function $a(s,e){let r=e,i={},c=Object.entries(s).reduce((m,[h,p])=>(m.push({offset:Number(r),data:p}),i[h]=r,r+=p.size,m),[]),l=new le;return l.push(on,r,String(r)),{data:[{offset:0,data:l},...c],map:i}}let Ca=4,Oa=s=>{let[e,r,...i]=s.params,c=s.meta[nn];I(i,"Cannot generate code for function without body"),I(c,"Cannot generate code for function without metadata");let{locals:l,argumentsCount:m}=c,h={code:[],locals:Object.keys(l).slice(m).map(p=>_r(l[p])),debug:`Function ${s.value}`};return h.code=i.map(fe(h)).reduce(ue,[]),h};function mn(s,e){let r={Version:e.version,Types:[],Start:[],Element:[],Code:[],Exports:[],Imports:[],Globals:[],Functions:[],Memory:[],Table:[],Artifacts:[],Data:[],Name:{module:e.filename,functions:[],locals:[]}},{statics:i}=s.meta[tn];e.linker!=null&&(i=P({},e.linker.statics,i));let{map:c,data:l}=$a(i,Ca);Object.keys(i).length>0&&(r.Data=l);let m=g=>{let A=Sr(g);return r.Types.findIndex(L=>{let R=L.params.length===A.params.length&&L.params.reduce((z,X,Q)=>z&&X===A.params[Q],!0),M=L.result===A.result;return R&&M})},h=g=>r.Element.findIndex(A=>A.functionIndex===g),p={},v=N({[d.Typedef]:(g,A)=>{let L=r.Types.findIndex(({id:M})=>M===g.value),R=r.Types[L];return R==null&&(L=r.Types.length,r.Types.push(wa(g))),R=P({},g,{meta:P({},g.meta,{[ft]:L})}),p[g.value]={typeIndex:L,typeNode:R},R}})(N({[d.Import]:(g,A)=>g,[d.StringLiteral]:(g,A)=>{let{value:L}=g;return c[L]==null?g:P({},g,{value:String(c[L]),Type:d.Constant})},[d.StaticValueList]:g=>{let{value:A}=g;return P({},g,{value:String(c[A]),Type:d.Constant})}})(s)),b={[d.Typedef]:(g,A)=>g,[d.Export]:g=>{let[A]=g.params;r.Exports.push(ga(A))},[d.ImmutableDeclaration]:g=>{switch(g.type){case"Memory":r.Memory.push(va(g));break;case"Table":r.Table.push(Sa(g));break}},[d.Declaration]:g=>{g.meta[Le]!=null&&r.Globals.push(Ta(g))},[d.Import]:g=>{r.Imports.push(...Aa(g))},[d.FunctionDeclaration]:g=>{let A=(()=>{let M=m(g);return M===-1?(r.Types.push(Sr(g)),r.Types.length-1):M})(),L=N({FunctionPointer(M){let X=M.meta[Oe],Q=h(X);return Q<0&&(Q=r.Element.length,r.Element.push(ba(X))),M}})(g),R=g.meta[Oe];if(I(R!=null,"Function index must be set"),r.Functions[R]=A,r.Code[R]=Oa(L),L.value==="start"&&r.Start.push(R),e.encodeNames){r.Name.functions.push({index:R,name:g.value});let M=g.meta[nn];M!=null&&Object.keys(M.locals).length&&(r.Name.locals[R]={index:R,locals:Object.entries(M.locals).map(([z,X])=>({name:z,index:Number(X.meta["local/index"])}))})}}};return D(b)(v),r.Code=r.Code.filter(Boolean),r}let Tr=1,La=1836278016;function Pa(s){return new le().push(on,La,"\\0asm").push(on,s,`version ${s}`)}let hn="varuint7",G="varuint32",yt="varint7",et="varint1",yn="varint32",Er="varint64";function Ue(s,e,r){s.push(G,e.length,r);for(let i=0;i<e.length;i++)s.push(ce,e.charCodeAt(i),e[i]);return s}let Ia=s=>{let e=new le().push(G,s.length,"entry count");return s.forEach(r=>{switch(Ue(e,r.module,"module"),Ue(e,r.field,"field"),r.kind){case ht:{e.push(ce,ht,"Global"),e.push(ce,r.type,Ut(r.type)),e.push(ce,0,"immutable");break}case fn:{e.push(ce,r.kind,"Function"),e.push(G,r.typeIndex,"type index");break}case zt:{e.push(ce,r.kind,"Table"),e.push(ce,pr,"function table types"),e.push(et,0,"has max value"),e.push(G,0,"iniital table size");break}case Gt:{e.push(ce,r.kind,"Memory"),e.push(et,!!r.max,"has no max"),e.push(G,r.initial,"initial memory size(PAGES)"),r.max&&e.push(G,r.max,"max memory size(PAGES)");break}}}),e},Na=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(({field:r,kind:i,index:c})=>{Ue(e,r,"field"),e.push(ce,i,"Global"),e.push(G,c,"index")}),e},Ra=(s,{type:e,init:r,mutable:i})=>{switch(s.push(ce,e,Ut(e)),s.push(ce,i,"mutable"),e){case Qe:s.push(ce,k.i32Const.code,k.i32Const.text),s.push(yn,r,`value (${r})`);break;case Ke:s.push(ce,k.f32Const.code,k.f32Const.text),s.push($,r,`value (${r})`);break;case Xe:s.push(ce,k.f64Const.code,k.f64Const.text),s.push(oe,r,`value (${r})`);break;case He:s.push(ce,k.i64Const.code,k.i64Const.text),s.push(Er,r,`value (${r})`)}s.push(ce,k.End.code,"end")},Ba=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(r=>Ra(e,r)),e},ka=s=>{s=s.filter(r=>r!==null);let e=new le;return e.push(G,s.length,"count"),s.forEach(r=>e.push(G,r,"type index")),e};function Fa(s){let e=new le;return e.push(G,s[0],"start function"),e}let Ma=s=>({functionIndex:e},r)=>{s.push(G,0,"table index"),s.push(ce,k.i32Const.code,"offset"),s.push(G,r,r.toString()),s.push(ce,k.End.code,"end"),s.push(G,1,"number of elements"),s.push(G,e,"function index")},ja=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(Ma(e)),e},Ua=(s,{params:e,result:r},i)=>{s.push(yt,fr,`func type (${i})`),s.push(G,e.length,"parameter count"),e.forEach(c=>s.push(yt,c,"param")),r?(s.push(et,1,"result count"),s.push(yt,r,`result type ${Ut(r)}`)):s.push(et,0,"result count")},Da=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach((r,i)=>Ua(e,r,i)),e},za=(s,e)=>{s.push(G,1,"number of locals of following type"),s.push(yt,e.type,`${Ut(e.type)}`)},Ga=(s,{locals:e,code:r,debug:i})=>{let c=new le;r.forEach(({kind:m,params:h,debug:p})=>{I(typeof m<"u",`Fatal error! Generated undefined opcode. debug code: ${JSON.stringify(p)}`),c.push(ce,m.code,`${m.text}  ${p||""}`),h.filter(v=>typeof v<"u").forEach(v=>{let b=G,g="i32.literal";if(m.code>=40&&m.code<=64)b=G,g="memory_immediate";else switch(m.result){case oe:b=oe,g="f64.literal";break;case $:b=$,g="f32.literal";break;case T:b=yn,g="i32.literal";break;case O:b=Er,g="i64.literal";break;default:b=G}c.push(b,v,`${g}`)})});let l=new le;e.forEach(m=>za(l,m)),s.push(G,c.size+l.size+2,i),s.push(G,e.length,"locals count"),s.write(l),s.write(c),s.push(ce,k.End.code,"end")},Ya=s=>{let e=new le;return e.push(G,s.length,"function count"),s.forEach(r=>Ga(e,r)),e},qa=(s,e)=>{s.push(et,e.max?1:0,"has no max"),s.push(G,e.initial,"initial memory size(PAGES)"),e.max&&s.push(G,e.max,"max memory size(PAGES)")},Va=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(r=>qa(e,r)),e},Ja={anyfunc:112},Wa=(s,e)=>{s.push(yt,Ja[e.type],e.type),s.push(et,e.max?1:0,"has max"),s.push(G,e.initial,"initial table size"),e.max&&s.push(G,e.max,"max table size")};function Qa(s){let e=new le;return e.push(G,s.length,"count"),s.forEach(r=>Wa(e,r)),e}let Ha=(s,e)=>{s.push(G,0,"memory index");let{offset:r,data:i}=e;s.push(ce,k.i32Const.code,k.i32Const.text),s.push(yn,r,`segment offset (${r})`),s.push(ce,k.End.code,"end"),s.push(G,i.size,"segment size"),s.write(i)};function Ka(s){let e=new le;e.push(G,s.length,"entries");for(let r=0,i=s.length;r<i;r++){let c=s[r];Ha(e,c)}return e}let Xa=s=>{let e=new le;return Ue(e,s,`name_len: ${s}`),e},Za=s=>{let e=new le;return e.push(G,s.length,`count: ${String(s.length)}`),s.forEach(({index:r,name:i})=>{e.push(G,r,`index: ${String(r)}`),Ue(e,i,`name_len: ${i}`)}),e},ei=s=>{let e=new le;return e.push(G,s.length,`count: ${String(s.length)}`),s.forEach(({index:r,locals:i})=>{e.push(G,r,`function index: ${String(r)}`),e.push(G,i.length,`number of params and locals ${i.length}`),i.forEach(({index:c,name:l})=>{e.push(G,c,`index: ${String(c)}`),Ue(e,l,`name_len: ${l}`)})}),e},ti=s=>{let e=new le;Ue(e,"name","name_len: name");let r=Xa(s.module);e.push(hn,0,"name_type: Module"),e.push(G,r.size,"name_payload_len"),e.write(r);let i=Za(s.functions);e.push(hn,1,"name_type: Function"),e.push(G,i.size,"name_payload_len"),e.write(i);let c=ei(s.locals);return e.push(hn,2,"name_type: Locals"),e.push(G,c.size,"name_payload_len"),e.write(c),e},ni=1,ri=2,si=3,oi=4,ai=5,ii=6,ci=7,li=8,ui=9,pi=10,fi=11,mi=0,Te=({type:s,label:e,emitter:r})=>i=>{let c=i[e];if(!c||Array.isArray(c)&&!c.length)return null;let l=new le().push(ce,s,e+" section"),m=r(c);return l.push(G,m.size,"size"),l.write(m),l};var Ee={type:Te({type:ni,label:"Types",emitter:Da}),imports:Te({type:ri,label:"Imports",emitter:Ia}),function:Te({type:si,label:"Functions",emitter:ka}),table:Te({type:oi,label:"Table",emitter:Qa}),memory:Te({type:ai,label:"Memory",emitter:Va}),exports:Te({type:ci,label:"Exports",emitter:Na}),globals:Te({type:ii,label:"Globals",emitter:Ba}),start:Te({type:li,label:"Start",emitter:Fa}),element:Te({type:ui,label:"Element",emitter:ja}),code:Te({type:pi,label:"Code",emitter:Ya}),data:Te({type:fi,label:"Data",emitter:Ka}),name:Te({type:mi,label:"Name",emitter:ti})};function dn(s,e){let i=new le().write(Pa(s.Version)).write(Ee.type(s)).write(Ee.imports(s)).write(Ee.function(s)).write(Ee.table(s)).write(Ee.memory(s)).write(Ee.globals(s)).write(Ee.exports(s)).write(Ee.start(s)).write(Ee.element(s)).write(Ee.code(s)).write(Ee.data(s));return e.encodeNames?i.write(Ee.name(s)):i}let hi=(s,e=0,r)=>{let i=0;return s.data.slice(e,r).map(({type:c,value:l,debug:m})=>{let h=`${i.toString()} 0x${i.toString(16)}`.padStart(6," ").padEnd(s.data.length.toString().length+1),p;Array.isArray(l)?p=l.map(b=>b.toString(16)).join().padStart(16):p=l.toString(16).padStart(16);let v=`${h}: ${p} ; ${m}`;return i+=an[c]||l.length,v}).join(`
`)+`
 ============ fin =============`},bn=s=>{let e=r=>{try{return s(`function fragment() {
        ${r}
      }`).params[0].params[2].params[0]}catch(i){throw new Error(`PANIC - Invalid fragment input:

${r}

Parse Error: ${i.stack}`)}};return(r,...i)=>{let c=!1,l=r.reduce((h,p,v)=>{let b=i[v];return b!=null&&typeof b!="object"?h+=p+String(b):b!=null?(c=!0,h+=p+`$$rep_${v}`):h+=p},""),m=e(l);return c?N({Identifier(h){let{value:p}=h;return p.indexOf("$$rep_")?h:i[Number(p.replace("$$rep_",""))]}})(m):m}},yi="0.21.0",di=(s,e)=>{let{version:r=Tr,encodeNames:i=!1,lines:c=s.split(`
`),filename:l="unknown",extensions:m=[]}=e||{},h=Zt([]),p=bn(h),v={version:r,encodeNames:i,lines:c,filename:l,extensions:m},b=h(s),g=cn(b,[],P({},v,{parser:h,stmt:p}));pn(g,{lines:c,filename:l});let A=mn(g,v);return dn(A,{version:r,encodeNames:i,filename:l,lines:c})},bi=(s,e)=>{let{filename:r="unknown.walt",extensions:i=[],linker:c,encodeNames:l=!1}=e||{},m={filename:r,lines:s.split(`
`),version:Tr,encodeNames:l},h=i.reduce((R,M)=>{let z=P({semantics:X=>({}),grammar:()=>({ParserRules:[]})},M(m));return R.grammar.push(z.grammar),R.semantics.push(z.semantics),R},{grammar:[],semantics:[]}),p=Zt(h.grammar),v=bn(p),b=p(s),g=cn(b,h.semantics,{parser:p,stmt:v});pn(g,m);let A=mn(g,P({},m,{linker:c})),L=dn(A,m);return{wasm:L,buffer(){return L.buffer()},ast:b,semanticAST:g}};return n.makeParser=Zt,n.makeFragment=bn,n.semantics=cn,n.validate=pn,n.generator=mn,n.emitter=dn,n.prettyPrintNode=dr,n.debug=hi,n.stringEncoder=cr,n.stringDecoder=Co,n.walkNode=D,n.mapNode=N,n.VERSION=yi,n.getIR=di,n.compile=bi,n}({}),zn=Qi;var Hi=n=>zn.compile(n).buffer(),Ki=n=>n.trim().length?JSON.stringify([...new Uint8Array(zn.compile(n).buffer())]):"[]",Xi=n=>{let t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(n)).filter(o=>!["constructor","initial_state","initial_component","__walt","css","init"].includes(o)).map(o=>t[o]=n[o].bind(n)),t},Zi=(n,t)=>{if(n.length){let o=new WebAssembly.Table({initial:10,element:"anyfunc"}),a=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(n).buffer),{tag:Xi(t),console,javascript:{table:o,setTimeout:(f,y)=>window.setTimeout(o.get(f),y),setInterval}}).exports,u={};return Object.keys(a).map(f=>u[f]=a[f]),u}return{}},fs={name:"Walt",uniqueBlock:"walt",compileWalt:Ki,compile:Hi,initWalt:Zi};function ec(n){return n;function t(f,y,_){var E;return _<0?_+=1:_>1&&(_-=1),6*_<1?E=f+(y-f)*_*6:2*_<1?E=y:3*_<2?E=f+(y-f)*(2/3-_)*6:E=f,255*E}function o(f,y,_){var E,w,N,F,D,te,I=Math;return y/=100,_/=100,y?(_<=.5?w=_*(y+1):w=_+y-_*y,E=_*2-w,N=f/360,F=I.ceil(t(E,w,N+1/3)),D=I.ceil(t(E,w,N)),te=I.ceil(t(E,w,N-1/3))):F=D=te=_*255,{r:F,g:D,b:te}}function a(f,y,_){return"#"+((1<<24)+(1*f<<16)+(1*y<<8)+1*_).toString(16).slice(1)}var u}var ms=ec;var hs={name:"min.css",processStyle:ms};var tc={walt:fs,mincss:hs},qe=tc;var Et;if(typeof window<"u"){class n extends HTMLElement{constructor(){super(),this.ShadowDOM="open",this.state=this.initial_state,this.__walt&&(this.walt=qe.walt.initWalt(this.__walt,this,this.state)),this.init&&this.init(),this.document=["open","closed"].includes(this.ShadowDOM)?this.attachShadow({mode:this.ShadowDOM}):this,this.initialize()}attributeChangedCallback(o,a,u){this.setAttribute(o,u)}}Et=class extends Ht(n){}}var Gn=class{constructor(){if(this.state=this.initial_state,this.init&&this.init(),this.document=document.querySelector(this.container),!this.document)throw`i.js: target container "${this.container}" not found`;this.initialize(),this.connectedCallback()}destroy(){this.disconnectedCallback()}},Kt=class extends Ht(Gn){};var ys=(n,t=0)=>{for(var o=3735928559^t,a=1103547991^t,u=0,f;u<n.length;u++)f=n.charCodeAt(u),o=Math.imul(o^f,2654435761),a=Math.imul(a^f,1597334677);return o=Math.imul(o^o>>>16,2246822507)^Math.imul(a^a>>>13,3266489909),a=Math.imul(a^a>>>16,2246822507)^Math.imul(o^o>>>13,3266489909),4294967296*(2097151&a)+(o>>>0)};function xt(n,t){return"i-"+String(ys(t||n.trim())).replaceAll("-","i")}var nc={},it=nc;var Yn={},rc=n=>n.split("-").map(t=>t.slice(0,1).toUpperCase()+t.slice(1)).join(""),sc=n=>((t,o)=>JSON.stringify(n,(a,u)=>typeof u=="function"?o.push(u)&&t:u).replace(new RegExp('"'+t+'"',"g"),a=>o.shift()))("____"+qr(50)+"____",[]),oc=(n,t)=>{if(Yn[n])return Yn[n];let o=URL.createObjectURL(new Blob([String.raw({raw:t})],{type:"text/javascript"}));return Yn[n]=o,o},ds=(n,t,o,a)=>n.reduce((u,f)=>{let y=t?"i.js:"+(f.path[0]==="/"?o:o+a)+"/"+f.path:oc(f.path,f.src);return f.type==="*"?u+"const "+f.import+" = {...(await import(`"+y+"`))};\n":f.type==="object"?u+"const "+f.import+" =  (await import(`"+y+"`));\n":u+"const "+f.import+" =  (await import(`"+y+"`)).default;\n"},"");function bs(n,t,{inFunc:o=!1}){let a=Object.values(qe).filter(D=>D.processStyle).reduce((D,te)=>te.processStyle(D),n.style||""),u=n.walt?qe.walt.compileWalt(n.walt):"undefined",f=`{${(n.state||"").trim()}}`,y=t!=="customElement"?"":new Function(`return 'static get observedAttributes() { return '+JSON.stringify(Object.keys(${f}))+' }'`)(),_=rc(n.name),E=sc(us(n.template,n.tag||[])),w=n.container?`get container()         { return "${n.container}" }`:"",N=`

        ${n.static||""};
        class ${_} extends ${t} {
            ${y}
            get initial_state()     { return ${f} }
            get initial_component() { return ${E} }
            get css()               { return \`${a}\`; }
            get __walt()            { return ${u} }
            ${w}
            ${n.class||""}
        };
    `,F=t==="customElement"?`
        ${n.import?ds(n.import,n.nodePath,n.BASE_URL,n.path):""}
        if(!customElements.get('${n.name}')) {
            ${N}
            customElements.define('${n.name}', ${_});
            window['iJS'].tags['${n.name}'] = true;
        }
    `:`
        ${n.import?ds(n.import,n.nodePath,n.BASE_URL,n.path):""}
        ${N} return new ${_}()`;return o?`;(async () => {${F}})();`:F}async function gs(n,t){let o=xt(n.innerText);await lt(n.innerText,{name:o,path:t}),n.replaceWith(document.createElement(o))}async function qn(n,t,o){await lt(n,{name:t,path:o})}async function Vn(n,t,o=""){if(it[n])return!0;let a=t.substr(-4)===".tag"?t:t+".tag",u=t[0]!=="/"?ct(o+a):a,f=await fetch(u).catch(_=>!1);if(f===!1)throw"i.js  \u2764\uFE0F error loading "+a;let y=u.substring(0,u.lastIndexOf("/"))+"/";await qn(await f.text(),n,y)}async function vs(n,t,o){await lt(n.innerText,{name:xt(n.innerText),path:o,container:t})}function ct(n){return typeof window>"u"?n:new URL(n,document.baseURI).pathname}async function Jn({source:n,path:t,keepName:o,nodeFetch:a,nodePath:u,BASE_URL:f}){let y=o?t.split("/").pop().split(".")[0]:xt(t);return{name:y,compiled:await lt(n,{name:y,path:t.substring(0,t.lastIndexOf("/"))+"/",bundle:!0,nodeFetch:a,nodePath:u,BASE_URL:f})}}async function _s(n,t){if(t)return await t(n);let o=await fetch(n).catch(a=>!1);if(o===!1)throw"i.js  \u2764\uFE0F error loading "+n;return(await o.text()).trim()}async function lt(n,t={}){let o=await ps(n);if(!t.name)throw"name is undefined !!!";o.name=t.name||"i-component",o.path=t.path,o.container=t.container||"",o.nodePath=t.nodePath?t.nodePath:void 0,o.BASE_URL=t.BASE_URL;let a=t.nodeFetch||void 0;var u="";if(o.style&&(o.style=o.style.trim(),o.style.length&&(u=o.style)),o.css)for(let f of o.css){let y=f[0]!=="/"?ct(o.path+f):f,_=await _s(y,a);_.length&&(u+=`
`+_)}if(o.style=u.replaceAll("`","`").trim(),o.tag)for(let f of o.tag){let y=f.path;y=ct(y.substr(-4)===".tag"?y:y+".tag"),a&&(y=ct(y[0]==="/"?y:o.path+y));let _=xt(y);f.name=_,a?f.src=await a(y):await Vn(_,y,o.path)}if(o.import&&!a)for(let f of o.import){let y=f.path[0]!=="/"?ct(o.path+f.path):f.path,_=await _s(y,a);f.src=_}if(it[o.name]=!0,o.container){let f=bs(o,"iElement",{inFunc:!1});return await new jn("iElement",f)(Kt)}else{let f=bs(o,"customElement",{inFunc:!0});if(t.bundle){if(o.tag){let y="";for(let _ of o.tag)if(it[_.name])console.log(`              <${_.name}> skipped`);else{let E=_.path.substr(-4)===".tag"?_.path:_.path+".tag";E[0]!=="/"&&(E=o.path+E);let{name:w,compiled:N}=await Jn({source:_.src,path:E,name:_.name,nodePath:ct(o.nodePath+o.path),BASE_URL:o.BASE_URL,nodeFetch:a});y+=N}return y+f}return f}await new jn("customElement",f)(Et)}}function ac(n,t){n.innerText.trim().length&&console.warn(`i.js \u2764\uFE0F  warning: contents of "<script type=i ${t.map(o=>o.name).join(" ")}> will be ignored"`)}function Ss(n,t){n.innerText.trim().length||console.warn(`i.js \u2764\uFE0F  warning: empty "<script type=i ${t.map(o=>o.name).join(" ")}>"`)}async function Ts(){let n=Array.from(document.querySelectorAll('script[type="i"]'));try{for(let t of n){let o=window.location.pathname,a=o.substring(0,o.lastIndexOf("/"))+"/",u=Array.prototype.slice.call(t.attributes).map(_=>({name:_.name,value:t.getAttribute(_.name).trim()})),f=u.find(_=>_.name==="target"&&_.value.length);if(f){u.length>2&&console.warn(`i.js \u2764\uFE0F  warning: all other attributes for "<script type=i target="${f.value}"> will be ignored"`),await vs(t,f.value,a),t.remove();continue}let y=u.filter(_=>_.name.includes("-"));if(y.length>1)throw`i.js \u2764\uFE0F  ERROR: more then one attribute with hyphens "<script ${y.map(_=>_.name).join(" ")}>"`;y.length===1?(y[0].value?(ac(t,u),await Vn(y[0].name,y[0].value,a)):(Ss(t,u),await qn(t.innerText,y[0].name,a)),t.remove()):(Ss(t,u),await gs(t,a))}}catch(t){throw new Yt(t)}}var Es="0.5.76";console.log(`i.js \u2764\uFE0F  ${Es} alpha experiment. Make DOM great again!`);var xs={VERSION:Es,tags:it,customElement:Et,createTag:lt,compile:Jn,plugins:qe},Pu=xs;typeof window<"u"&&(window.iJS=xs,document.addEventListener("DOMContentLoaded",Ts));})();
/**
 * WASM types
 *
 * https://github.com/WebAssembly/spec/tree/master/interpreter#s-expression-syntax
 *
 * Plus some extra C type mappings
 *
 * @author arthrubuldauskas@gmail.com
 * @license MIT
 */
/**
 * min.css
 *
 * min.css is a tiny, fast and efficient JavaScript library for minifying CSS
 * files that really makes your website faster
 *
 * Site: https://github.com/w3core/min.css/
 * Online: https://w3core.github.io/min.css/
 *
 * @version 1.3.1
 *
 * @license BSD License
 * @author Max Chuhryaev
 */
